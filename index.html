<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot Dashboard - Enhanced</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>

         .nav-tabs {
            display: flex;
            gap: 20px;
        }
        .platform-card.locked {
    position: relative;
}

.platform-card.locked:hover {
    border-color: #f97316 !important;
    background-color: #fff7ed !important;
}

.upgrade-prompt {
    background: linear-gradient(90deg, #f97316, #ea580c);
    color: white;
    padding: 12px;
    border-radius: 8px;
    margin: 16px 0;
    text-align: center;
}

.enterprise-only {
    display: none;
}

.billing-section {
    margin-top: 20px;
}

@keyframes pulse-orange {
    0%, 100% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(249, 115, 22, 0); }
}

.upgrade-pulse {
    animation: pulse-orange 2s infinite;
}
        .nav-tab {
            padding: 8px 16px;
            background: none;
            border: none;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .nav-tab.active {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            background: #f59e0b;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .action-btn {
            padding: 8px 16px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .action-btn.primary {
            background: white;
            color: #6366f1;
            border-color: white;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        .node-palette {
            width: 320px;
            background: white;
            border-right: 1px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 8px rgba(0,0,0,0.05);
        }

        .palette-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .search-box {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .search-box:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .build-suggestion {
            margin: 15px 0;
            padding: 12px;
            background: #ede9fe;
            border: 1px solid #c4b5fd;
            border-radius: 8px;
            color: #5b21b6;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .palette-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .node-category {
            margin-bottom: 25px;
        }

        .category-title {
            font-size: 16px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .node-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .palette-node {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            cursor: grab;
            transition: all 0.2s ease;
            user-select: none;
        }

        .palette-node:hover {
            background: #f3f4f6;
            border-color: #6366f1;
            transform: translateY(-1px);
        }

        .palette-node:active {
            cursor: grabbing;
        }

        .palette-node.dragging {
            opacity: 0.5;
        }

        .node-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .node-label {
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }

        .canvas-area {
            flex: 1;
            position: relative;
            background: #4a5568;
            background-image: 
                radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            overflow: hidden;
        }

        .canvas {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: auto;
        }

        .starting-node {
            position: absolute;
            top: 50px;
            left: 50px;
            background: white;
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            min-width: 160px;
            cursor: move;
        }

        .workflow-node {
            position: absolute;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            min-width: 160px;
            cursor: move;
            user-select: none;
            transition: all 0.2s ease;
        }

        .workflow-node:hover {
            border-color: #6366f1;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .workflow-node.selected {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .node-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .node-type-icon {
            width: 20px;
            height: 20px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .node-title {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            flex: 1;
        }

        .node-content {
            font-size: 12px;
            color: #6b7280;
            line-height: 1.4;
        }

        .connection-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #6366f1;
            border: 2px solid white;
            border-radius: 50%;
            cursor: crosshair;
            z-index: 10;
            transition: all 0.2s ease;
        }

        .connection-point:hover {
            transform: scale(1.3);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
        }

        .input-point {
            left: -6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .output-point {
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .connection-line {
            position: absolute;
            pointer-events: none;
            z-index: 1;
        }

        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .connection-path {
            fill: none;
            stroke: #6366f1;
            stroke-width: 2;
            opacity: 0.8;
        }

        .temp-connection {
            stroke: #6366f1;
            stroke-width: 2;
            stroke-dasharray: 5,5;
            opacity: 0.6;
        }

        .zoom-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .zoom-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: white;
            color: #374151;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: background-color 0.2s ease;
        }

        .zoom-btn:hover {
            background: #f3f4f6;
        }

        .zoom-level {
            padding: 0 12px;
            font-size: 14px;
            color: #374151;
            border-left: 1px solid #e5e7eb;
            border-right: 1px solid #e5e7eb;
        }

        .drop-zone {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(99, 102, 241, 0.1);
            border: 2px dashed #6366f1;
            display: none;
            align-items: center;
            justify-content: center;
            color: #6366f1;
            font-size: 18px;
            font-weight: 600;
            z-index: 100;
        }

        .drop-zone.active {
            display: flex;
        }

        .mini-toolbar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .mini-toolbar-btn {
            padding: 10px 15px;
            border: none;
            background: white;
            color: #374151;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s ease;
            border-right: 1px solid #e5e7eb;
        }

        .mini-toolbar-btn:last-child {
            border-right: none;
        }

        .mini-toolbar-btn:hover {
            background: #f3f4f6;
        }

        /* Node type specific styles */
        .question-node { border-color: #f59e0b; }
        .date-node { border-color: #ef4444; }
        .name-node { border-color: #10b981; }
        .number-node { border-color: #3b82f6; }
        .phone-node { border-color: #8b5cf6; }
        .url-node { border-color: #06b6d4; }
        .address-node { border-color: #f97316; }
        .button-node { border-color: #6366f1; }
        .autocomplete-node { border-color: #84cc16; }



        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .bot-type-section { display: none; }
        .bot-type-section.active { display: block; }
        .color-picker {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
        }
        .color-picker:hover {
            border-color: #3b82f6;
        }
        /* Settings Page Styles */
.content-section {
    padding: 2rem;
}
.feature-enabled {
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
}

.feature-disabled {
    background: #E5E7EB;
}

.checkbox-container {
    transition: all 0.3s ease;
}

.checkbox-container:hover {
    background-color: #F3F4F6;
    border-radius: 0.5rem;
    padding: 0.5rem;
}
.page-header {
    display: flex;
    align-items: center;
    margin-bottom: 2rem;
}

.page-header .icon {
    font-size: 2rem;
    margin-right: 1rem;
}

.page-title {
    font-size: 2.5rem;
    font-weight: bold;
    color: #1f2937;
    margin: 0;
}

.success-message {
    background: #d1fae5;
    border: 1px solid #10b981;
    color: #065f46;
    padding: 1rem;
    border-radius: 0.5rem;
    margin-bottom: 1.5rem;
    display: none;
    align-items: center;
    gap: 0.5rem;
}

.success-message.show {
    display: flex;
}

.settings-card {
    background: white;
    border-radius: 0.75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    padding: 2rem;
    margin-bottom: 2rem;
}

.settings-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
}

.profile-section {
    grid-column: 1 / -1;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 1.5rem;
    background: #f9fafb;
    border-radius: 0.5rem;
    margin-bottom: 1rem;
}

.profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: #3b82f6;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
}

.profile-info h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.25rem;
    font-weight: 600;
}

.profile-info p {
    margin: 0 0 1rem 0;
    color: #6b7280;
    font-size: 0.875rem;
}

.upload-btn {
    background: #3b82f6;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    cursor: pointer;
    font-size: 0.875rem;
}

.upload-btn:hover {
    background: #2563eb;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
}

.form-label .icon {
    font-size: 1rem;
}

.form-input {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.form-input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.password-container {
    position: relative;
}

.password-toggle {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
}

.form-actions {
    grid-column: 1 / -1;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
    margin-top: 1rem;
}

.btn {
    padding: 0.75rem 1.5rem;
    border-radius: 0.375rem;
    font-weight: 500;
    cursor: pointer;
    border: none;
    transition: background-color 0.15s ease-in-out;
}

.btn-primary {
    background: #3b82f6;
    color: white;
}

.btn-primary:hover {
    background: #2563eb;
}

.btn-secondary {
    background: #f3f4f6;
    color: #374151;
    border: 1px solid #d1d5db;
}

.btn-secondary:hover {
    background: #e5e7eb;
}

.settings-section {
    padding: 0;
}

.section-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.5rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 1.5rem;
}

.settings-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 0;
    border-bottom: 1px solid #f3f4f6;
}

.settings-item:last-child {
    border-bottom: none;
}

.setting-info h4 {
    margin: 0 0 0.25rem 0;
    font-weight: 500;
    color: #1f2937;
}

.setting-info p {
    margin: 0;
    color: #6b7280;
    font-size: 0.875rem;
}

.toggle-switch {
    width: 48px;
    height: 24px;
    background: #d1d5db;
    border-radius: 12px;
    position: relative;
    cursor: pointer;
    transition: background-color 0.2s ease;
}
.sidebar-content {
            padding: 20px;
            background: white;
        }

        .component-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 12px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .component-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            user-select: none;
        }

        .component-item:hover {
            background: #e3f2fd;
            border-color: #2196F3;
            transform: translateY(-1px);
        }

        .component-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .component-text {
            font-size: 14px;
            font-weight: 500;
            color: #333;

.toggle-switch::after {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: white;
    top: 2px;
    left: 2px;
    transition: transform 0.2s ease;
}

.toggle-switch.active {
    background: #10b981;
}

.toggle-switch.active::after {
    transform: translateX(24px);
}

@media (max-width: 768px) {
    .settings-form {
        grid-template-columns: 1fr;
    }
    
    .profile-section {
        flex-direction: column;
        text-align: center;
    }
}

    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="min-h-screen flex">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-lg">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-gray-800">ChatBot Studio</h1>
            </div>
         <nav class="mt-6">
    <a href="#dashboard" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600 border-r-3 border-blue-600">
        <i class="fas fa-tachometer-alt mr-3"></i>Dashboard
    </a>
    <a href="#builder" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600">
        <i class="fas fa-robot mr-3"></i>Bot Builder
    </a>
    <a href="#analytics" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600">
        <i class="fas fa-chart-line mr-3"></i>Analytics & Logs
    </a>
    <a href="#billing" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600">
        <i class="fas fa-credit-card mr-3"></i>Billing
    </a>
    <!-- Teams & Users - Hidden by default, shown for Enterprise -->
    <a href="#teams" id="teamsNavLink" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600" style="display: none;">
        <i class="fas fa-users mr-3"></i>Teams & Users
    </a>
    <!-- Upgrade Plan Option -->

    <a href="#settings" class="block px-6 py-3 text-gray-600 hover:bg-blue-50 hover:text-blue-600">
        <i class="fas fa-cog mr-3"></i>Settings
    </a>
</nav>

<!-- Simple Upgrade Popup Modal -->
<div id="upgradeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto">
        <div class="p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Choose Your Plan</h2>
                <button onclick="closeUpgradeModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="grid md:grid-cols-3 gap-6">
                <!-- Your 3 pricing cards here -->
            </div>
        </div>
    </div>
</div>

        </div>

        <!-- Main Content -->
        <div class="flex-1 p-8">
            <!-- Dashboard Tab -->
           <div id="dashboard" class="tab-content active">
    <!-- Header Section -->
    <div class="mb-8">
        <div class="flex justify-between items-center">
            <div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Dashboard Overview</h2>
                <p class="text-gray-600">Welcome back, Here's what's happening with your chatbots today.</p>
            </div>
            <!-- Plan Status & Upgrade Trigger -->
            <div class="flex items-center space-x-3">
                <span id="currentPlanBadge" class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Free Plan</span>
                <button id="upgradeButton" onclick="showUpgradeModal()" class="px-4 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all">
                    <i class="fas fa-crown mr-2"></i>Upgrade
                </button>
            </div>
        </div>
    </div>

    <!-- Enterprise Onboarding Flow (Hidden initially) -->
    <div id="enterpriseOnboarding" class="mb-8 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 border border-blue-200" style="display: none;">
        <div class="flex items-center justify-between mb-4">
            <div>
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-rocket text-purple-600 mr-2"></i>
                    Welcome to Enterprise Mode! 🎉
                </h3>
                <p class="text-gray-600">Complete these steps to unlock full team collaboration</p>
            </div>
            <button id="dismissOnboarding" class="text-gray-400 hover:text-gray-600" onclick="dismissOnboarding()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="grid md:grid-cols-3 gap-4" id="onboardingSteps">
            <!-- Step 1: Create Team -->
            <div class="bg-white rounded-lg p-4 border-l-4 border-blue-500" id="step1">
                <div class="flex items-center mb-2">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                        <span class="text-blue-600 font-bold text-sm">1</span>
                    </div>
                    <h4 class="font-semibold">Create Your First Team</h4>
                    <i id="step1Check" class="fas fa-check text-green-500 ml-auto" style="display: none;"></i>
                </div>
                <p class="text-sm text-gray-600 mb-3">Organize your projects and collaborate with team members</p>
                <button onclick="createFirstTeam()" class="text-blue-600 text-sm font-medium hover:text-blue-700">
                    <i class="fas fa-plus mr-1"></i>Create Team →
                </button>
            </div>
            
            <!-- Step 2: Invite Users -->
            <div class="bg-white rounded-lg p-4 border-l-4 border-green-500" id="step2">
                <div class="flex items-center mb-2">
                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                        <span class="text-green-600 font-bold text-sm">2</span>
                    </div>
                    <h4 class="font-semibold">Invite Team Members</h4>
                    <i id="step2Check" class="fas fa-check text-green-500 ml-auto" style="display: none;"></i>
                </div>
                <p class="text-sm text-gray-600 mb-3">Add users and assign roles for collaborative development</p>
                <button onclick="inviteFirstUser()" class="text-green-600 text-sm font-medium hover:text-green-700">
                    <i class="fas fa-envelope mr-1"></i>Invite Users →
                </button>
            </div>
            
            <!-- Step 3: Create Team Chatbot -->
            <div class="bg-white rounded-lg p-4 border-l-4 border-purple-500" id="step3">
                <div class="flex items-center mb-2">
                    <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3">
                        <span class="text-purple-600 font-bold text-sm">3</span>
                    </div>
                    <h4 class="font-semibold">Create Team Chatbot</h4>
                    <i id="step3Check" class="fas fa-check text-green-500 ml-auto" style="display: none;"></i>
                </div>
                <p class="text-sm text-gray-600 mb-3">Build your first collaborative chatbot project</p>
                <button onclick="createTeamBot()" class="text-purple-600 text-sm font-medium hover:text-purple-700">
                    <i class="fas fa-robot mr-1"></i>Create Bot →
                </button>
            </div>
        </div>
    </div>

    <!-- Free Plan Upgrade Triggers (Shown only in Free plan) -->
    <div id="freeUpgradeBanner" class="mb-8 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-exclamation-triangle text-yellow-600 mr-3"></i>
                <div>
                    <h4 class="font-medium text-gray-800">Unlock Team Collaboration</h4>
                    <p class="text-sm text-gray-600">Need to collaborate with your team? Upgrade to Enterprise for unlimited features!</p>
                </div>
            </div>
            <button onclick="showUpgradeModal()" class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 whitespace-nowrap">
                Upgrade Now
            </button>
        </div>
    </div>

    <!-- Enterprise Team Management Section (Hidden initially) -->
    <div id="enterpriseTeamSection" class="mb-8" style="display: none;">
        <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h3 class="text-xl font-semibold flex items-center">
                        <i class="fas fa-users text-blue-600 mr-2"></i>
                        Team Management
                        <span class="ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium">Enterprise</span>
                    </h3>
                    <p class="text-gray-600">Manage teams, users, and collaborative projects</p>
                </div>
                <div class="flex space-x-3">
                    <button onclick="createTeam()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Create Team
                    </button>
                    <button onclick="inviteUser()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-envelope mr-2"></i>Invite User
                    </button>
                </div>
            </div>

            <!-- Teams Grid -->
            <div class="grid md:grid-cols-3 gap-4 mb-6" id="teamsGrid">
                <!-- Teams will be populated here -->
            </div>

            <!-- User Management Panel -->
            <div class="border-t pt-6">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="font-semibold flex items-center">
                        <i class="fas fa-user-friends text-gray-600 mr-2"></i>
                        User Management Panel
                    </h4>
                    <select id="roleFilter" class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                        <option value="all">All Roles</option>
                        <option value="admin">Admin</option>
                        <option value="editor">Editor</option>
                        <option value="viewer">Viewer</option>
                    </select>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full" id="userManagementTable">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">User</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Role</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Teams</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Last Active</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-4 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-medium">A</div>
                                        <div class="ml-3">
                                            <div class="font-medium text-gray-900">Sam (You)</div>
                                            <div class="text-sm text-gray-500">sam@example.com</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-4 py-4 whitespace-nowrap">
                                    <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Admin</span>
                                </td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">All Teams</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Online now</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                                    <div class="flex space-x-2">
                                        <button class="text-blue-600 hover:text-blue-900">Edit Role</button>
                                        <button class="text-green-600 hover:text-green-900">Manage Teams</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div class="bg-white p-6 rounded-lg shadow relative">
            <div class="text-3xl font-bold text-blue-600" id="totalChatbots">3</div>
            <div class="text-gray-600">Total Chatbots</div>
            <!-- Free Plan Limit Warning -->
            <div id="chatbotLimitWarning" class="text-xs text-red-500 mt-1">
                <i class="fas fa-exclamation-circle mr-1"></i>Limit: 1 chatbot
            </div>
            <!-- Enterprise Unlimited Badge -->
            <div id="unlimitedBadge" class="text-xs text-green-600 mt-1" style="display: none;">
                <i class="fas fa-infinity mr-1"></i>Unlimited
            </div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-green-600">2</div>
            <div class="text-gray-600">Active Bots</div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-purple-600">2,847</div>
            <div class="text-gray-600">Total Messages</div>
            <!-- Enterprise Team Analytics -->
            <div id="teamAnalytics" class="text-xs text-gray-500 mt-1" style="display: none;">
                <i class="fas fa-users mr-1"></i>Across 2 teams
            </div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-orange-600">156</div>
            <div class="text-gray-600">Today's Interactions</div>
        </div>
    </div>

    <!-- Enhanced Chatbots Section -->
    <div class="bg-white rounded-lg shadow p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-semibold">Your Chatbots</h3>
            <!-- Enterprise Create Options -->
            <div id="enterpriseCreateOptions" style="display: none;">
                <div class="flex space-x-2">
                    <button onclick="createPersonalBot()" class="px-3 py-1 bg-gray-600 text-white rounded text-sm hover:bg-gray-700">
                        <i class="fas fa-user mr-1"></i>Personal Bot
                    </button>
                    <button onclick="createTeamBot()" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                        <i class="fas fa-users mr-1"></i>Team Bot
                    </button>
                </div>
            </div>
            <!-- Free Plan Create Limitation -->
            <div id="freeCreateLimit">
                <button onclick="showChatbotLimitModal()" class="px-3 py-1 bg-gray-300 text-gray-600 rounded text-sm cursor-not-allowed">
                    <i class="fas fa-lock mr-1"></i>Create Bot (Upgrade Required)
                </button>
            </div>
        </div>
        
        <div class="space-y-4">
            <div class="border rounded-lg p-4 flex justify-between items-center">
                <div>
                    <div class="flex items-center space-x-2">
                        <h4 class="font-semibold">Customer Support Bot</h4>
                        <!-- Team Collaboration Tags -->
                        <span id="bot1TeamTag" class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs" style="display: none;">
                            <i class="fas fa-users mr-1"></i>Support Team
                        </span>
                    </div>
                    <p class="text-sm text-gray-600">Type: Web • Created 2 days ago • Last active 5 minutes ago</p>
                </div>
                <div class="flex items-center space-x-3">
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">Active</span>
                    <button class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">Configure</button>
                    <!-- Enterprise Collaboration Button -->
                    <button id="bot1Collaborate" onclick="manageBotCollaboration(1)" class="px-3 py-1 bg-purple-600 text-white rounded text-sm hover:bg-purple-700" style="display: none;">
                        <i class="fas fa-users mr-1"></i>Collaborate
                    </button>
                </div>
            </div>
            
            <div class="border rounded-lg p-4 flex justify-between items-center">
                <div>
                    <div class="flex items-center space-x-2">
                        <h4 class="font-semibold">Sales Assistant</h4>
                        <span id="bot2TeamTag" class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs" style="display: none;">
                            <i class="fas fa-users mr-1"></i>Marketing Team
                        </span>
                    </div>
                    <p class="text-sm text-gray-600">Type: WhatsApp • Created 1 week ago • Last active 2 hours ago</p>
                </div>
                <div class="flex items-center space-x-3">
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">Active</span>
                    <button class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">Configure</button>
                    <button id="bot2Collaborate" onclick="manageBotCollaboration(2)" class="px-3 py-1 bg-purple-600 text-white rounded text-sm hover:bg-purple-700" style="display: none;">
                        <i class="fas fa-users mr-1"></i>Collaborate
                    </button>
                </div>
            </div>
            
            <div class="border rounded-lg p-4 flex justify-between items-center">
                <div>
                    <div class="flex items-center space-x-2">
                        <h4 class="font-semibold">FAQ Bot</h4>
                        <span id="bot3PersonalTag" class="px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs" style="display: none;">
                            <i class="fas fa-user mr-1"></i>Personal
                        </span>
                    </div>
                    <p class="text-sm text-gray-600">Type: Messenger • Created 3 weeks ago • Last active yesterday</p>
                </div>
                <div class="flex items-center space-x-3">
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm">Inactive</span>
                    <button class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">Configure</button>
                    <button id="bot3Collaborate" onclick="manageBotCollaboration(3)" class="px-3 py-1 bg-purple-600 text-white rounded text-sm hover:bg-purple-700" style="display: none;">
                        <i class="fas fa-users mr-1"></i>Collaborate
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>


            <!-- Bot Builder Tab -->
            <div id="builder" class="tab-content">
               <div x-data="{ 
    showCreationForm: true,
    showConfiguration: false,
    showConfigMessage: false,
    selectedType: '',
    botName: '',
    botDescription: '',
    selectedPersona: 'friendly-support',
    temperature: 0.7,
    maxTokens: 150,
    currentTab: 'basic',
    enablePersonaDesign: false, // NEW: Control persona tab visibility
    
    // Design customization
    selectedDesign: 'default',
    customColors: {
        primary: '#3B82F6',
        secondary: '#EFF6FF',
        accent: '#1D4ED8',
        text: '#1F2937'
    },
    selectedIcon: 'fas fa-robot',
    borderRadius: 'rounded-lg',
    shadowStyle: 'shadow-md',
    
    // ... rest of your existing properties
    
    createBot() {
        if(this.botName.trim() === '') {
            alert('Please enter a bot name');
            return;
        }
        this.showCreationForm = false;
        this.showConfigMessage = true;
    },
    
    startConfiguration() {
        this.showConfigMessage = false;
        this.showConfiguration = true;
    },
    
    selectPersona(persona) {
        this.selectedPersona = persona;
        if(this.personaDesigns[persona]) {
            this.customColors = {...this.personaDesigns[persona].colors};
            this.selectedIcon = this.personaDesigns[persona].icon;
        }
    },
    
    updatePreview() {
        // This function will be called when design elements change
        // to update the live preview
    },
    
    // NEW: Method to handle tab visibility
    updateTabVisibility() {
        // If persona design is disabled and user is on that tab, switch to basic tab
        if (!this.enablePersonaDesign && this.currentTab === 'persona') {
            this.currentTab = 'basic';
        }
    }
}">

                    
                    <!-- Bot Creation Form -->
                    <div x-show="showCreationForm">
                        <div class="mb-8">
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Create New Chatbot</h2>
                            <p class="text-gray-600">Start by giving your chatbot a name and description.</p>
                        </div>

                        <div class="bg-white rounded-lg shadow p-8 max-w-2xl mx-auto">
                            <div class="space-y-6">
                                <!-- Bot Name -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Bot Name *</label>
                                    <input type="text" x-model="botName" placeholder="e.g., Customer Support Bot" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>

                                <!-- Bot Description -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description (Optional)</label>
                                    <textarea x-model="botDescription" rows="4" 
                                        placeholder="Describe what your bot will do. e.g., Help customers with order inquiries, product information, and general support."
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>

                                <!-- Platform Selection -->
                              <div>
    <label class="block text-sm font-medium text-gray-700 mb-3">Choose Platform</label>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <!-- Web Platform - Always Available -->
        <div class="platform-card border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" 
             data-platform="web" onclick="selectPlatform('web')">
            <i class="fas fa-globe text-3xl text-blue-600 mb-3"></i>
            <div class="text-sm font-medium">Web</div>
        </div>
        
        <!-- WhatsApp Platform - Locked for Free Users -->
        <div class="platform-card locked border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer relative opacity-60" 
             data-platform="whatsapp" onclick="showUpgradeModal('WhatsApp')">
            <div class="absolute -top-2 -right-2 bg-orange-500 text-white text-xs px-2 py-1 rounded-full">
                ENTERPRISE
            </div>
            <div class="absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-20 rounded-lg">
                <i class="fas fa-lock text-gray-600 text-2xl"></i>
            </div>
            <i class="fab fa-whatsapp text-3xl text-green-600 mb-3"></i>
            <div class="text-sm font-medium">WhatsApp</div>
        </div>
        
        <!-- Messenger Platform - Locked for Free Users -->
        <div class="platform-card locked border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer relative opacity-60" 
             data-platform="messenger" onclick="showUpgradeModal('Messenger')">
            <div class="absolute -top-2 -right-2 bg-orange-500 text-white text-xs px-2 py-1 rounded-full">
                ENTERPRISE
            </div>
            <div class="absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-20 rounded-lg">
                <i class="fas fa-lock text-gray-600 text-2xl"></i>
            </div>
            <i class="fab fa-facebook-messenger text-3xl text-blue-600 mb-3"></i>
            <div class="text-sm font-medium">Messenger</div>
        </div>
        
        <!-- API Platform - Available based on plan -->
        <div class="platform-card border-2 border-gray-200 rounded-lg p-4 text-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors" 
             data-platform="api" onclick="selectPlatform('api')">
            <i class="fas fa-code text-3xl text-purple-600 mb-3"></i>
            <div class="text-sm font-medium">API</div>
        </div>
    </div>
</div>

<!-- Upgrade Modal -->
<div id="upgradeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg p-8 max-w-2xl mx-4 relative">
        <button onclick="closeUpgradeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
            <i class="fas fa-times text-xl"></i>
        </button>
        
        <div class="text-center mb-6">
            <div class="mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-crown text-orange-500 text-2xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-900 mb-2">Upgrade to Enterprise</h3>
            <p class="text-gray-600" id="upgradeDescription">Unlock advanced platform integrations and team collaboration features</p>
        </div>

        <!-- Plan Comparison -->
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- Free Plan -->
            <div class="border rounded-lg p-6">
                <h4 class="font-semibold text-lg mb-4 text-center">Free Plan</h4>
                <div class="text-center mb-4">
                    <span class="text-3xl font-bold">€0</span>
                    <span class="text-gray-600">/month</span>
                </div>
                <ul class="space-y-2 text-sm">
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> 1 Web chatbot</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Basic analytics</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Personal workspace</li>
                    <li class="flex items-center text-gray-400"><i class="fas fa-times text-gray-400 mr-2"></i> WhatsApp integration</li>
                    <li class="flex items-center text-gray-400"><i class="fas fa-times text-gray-400 mr-2"></i> Messenger integration</li>
                    <li class="flex items-center text-gray-400"><i class="fas fa-times text-gray-400 mr-2"></i> Team collaboration</li>
                </ul>
            </div>

            <!-- Enterprise Plan -->
            <div class="border-2 border-orange-500 rounded-lg p-6 relative">
                <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-orange-500 text-white px-4 py-1 rounded-full text-sm font-medium">
                    RECOMMENDED
                </div>
                <h4 class="font-semibold text-lg mb-4 text-center">Enterprise Plan</h4>
                <div class="text-center mb-4">
                    <span class="text-3xl font-bold">€400</span>
                    <span class="text-gray-600">/month</span>
                </div>
                <ul class="space-y-2 text-sm">
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Unlimited chatbots</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> All platform integrations</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Team management</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Advanced analytics</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Priority support</li>
                    <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i> Role-based access</li>
                </ul>
            </div>
        </div>

        <div class="flex gap-4 justify-center">
            <button onclick="closeUpgradeModal()" class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                Maybe Later
            </button>
            <button onclick="initiateUpgrade()" class="px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">
                Upgrade Now
            </button>
        </div>
    </div>
</div>


                                <!-- Create Button -->
                                <div class="flex justify-center pt-6">
                                    <button @click="createBot()" 
                                        class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-lg">
                                        <i class="fas fa-robot mr-2"></i>Create Bot
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Configuration Message -->
                    <div x-show="showConfigMessage" class="text-center">
                        <div class="mb-8">
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Bot Created Successfully!</h2>
                            <p class="text-gray-600">Your bot "<span x-text="botName" class="font-semibold text-blue-600"></span>" has been created.</p>
                        </div>

                        <div class="bg-white rounded-lg shadow p-8 max-w-lg mx-auto">
                            <div class="mb-6">
                                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-check text-3xl text-green-600"></i>
                                </div>
                                <h3 class="text-xl font-semibold mb-2">Ready to Configure!</h3>
                                <p class="text-gray-600">Configure your chatbot by clicking the configure button below to set up its behavior and responses.</p>
                            </div>
                            
                            <button @click="startConfiguration()" 
                                class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium">
                                <i class="fas fa-cog mr-2"></i>Configure Bot
                            </button>
                        </div>
                    </div>

                    <!-- Configuration Section -->
                    <div x-show="showConfiguration">
                        <div class="mb-8">
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Configure Your Bot</h2>
                            <p class="text-gray-600">Bot: <span x-text="botName" class="font-semibold text-blue-600"></span></p>
                        </div>

                        <div class="bg-white rounded-lg shadow p-6">
                            <!-- Bot Type Selection -->
                            <div class="mb-8">
                                <h3 class="text-xl font-semibold mb-4">Choose Bot Type</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <!-- AI-Powered -->
                                    <div @click="selectedType = 'ai-powered'" 
                                        :class="selectedType === 'ai-powered' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'"
                                        class="border-2 rounded-lg p-6 cursor-pointer transition-colors">
                                        <div class="text-center">
                                            <i class="fas fa-brain text-4xl text-blue-600 mb-4"></i>
                                            <h4 class="text-lg font-semibold mb-2">AI-Powered</h4>
                                            <p class="text-sm text-gray-600 mb-4">Uses advanced AI models to understand and respond to user queries naturally.</p>
                                            <div class="text-xs text-gray-500">
                                                <div>✓ Natural language processing</div>
                                                <div>✓ Context awareness</div>
                                                <div>✓ Dynamic responses</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Rule-Based -->
                                    <div @click="selectedType = 'rule-based'" 
                                        :class="selectedType === 'rule-based' ? 'border-green-500 bg-green-50' : 'border-gray-200 hover:border-gray-300'"
                                        class="border-2 rounded-lg p-6 cursor-pointer transition-colors">
                                        <div class="text-center">
                                            <i class="fas fa-sitemap text-4xl text-green-600 mb-4"></i>
                                            <h4 class="text-lg font-semibold mb-2">Rule-Based</h4>
                                            <p class="text-sm text-gray-600 mb-4">Uses predefined rules and decision trees to handle user interactions.</p>
                                            <div class="text-xs text-gray-500">
                                                <div>✓ Predictable responses</div>
                                                <div>✓ Fast processing</div>
                                                <div>✓ Full control</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Hybrid -->
                                    <div @click="selectedType = 'hybrid'" 
                                        :class="selectedType === 'hybrid' ? 'border-purple-500 bg-purple-50' : 'border-gray-200 hover:border-gray-300'"
                                        class="border-2 rounded-lg p-6 cursor-pointer transition-colors">
                                        <div class="text-center">
                                            <i class="fas fa-layer-group text-4xl text-purple-600 mb-4"></i>
                                            <h4 class="text-lg font-semibold mb-2">Hybrid</h4>
                                            <p class="text-sm text-gray-600 mb-4">Combines rule-based logic with AI intelligence for optimal performance.</p>
                                            <div class="text-xs text-gray-500">
                                                <div>✓ Best of both worlds</div>
                                                <div>✓ Fallback handling</div>
                                                <div>✓ Maximum flexibility</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Configuration Tabs (Show only when type is selected) -->
                            <div x-show="selectedType !== ''" class="border-t pt-6">
                                <!-- Tab Navigation -->
                               <!-- Tab Navigation -->



</div>


                                <!-- Basic Setup Tab -->
                                <!-- Basic Setup Tab -->
<div x-show="currentTab === 'basic'" class="space-y-6">
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <h4 class="font-semibold text-blue-800 mb-2">Bot Information</h4>
        <div class="text-blue-700 text-sm space-y-1">
            <div><strong>Name:</strong> <span x-text="botName"></span></div>
            <div x-show="botDescription"><strong>Description:</strong> <span x-text="botDescription"></span></div>
            <div><strong>Type:</strong> <span x-text="selectedType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span></div>
        </div>
    </div>

    <!-- Welcome Message -->
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Welcome Message</label>
        <textarea rows="3" placeholder="Hello! I'm here to help you. How can I assist you today?" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
    </div>

    <!-- Fallback Message -->
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Fallback Message</label>
        <textarea rows="2" placeholder="I'm sorry, I didn't understand that. Could you please rephrase your question?" 
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
    </div>
    <div>
 <div class="relative">
    <input type="text" placeholder="Enter URL to train..."
      class="w-full pl-4 pr-24 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <button
      class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-blue-600 text-white px-4 py-1 rounded-md hover:bg-blue-700">
      Train
    </button>
  </div>
  <!-- <label class="block text-sm font-medium text-gray-700 mb-2">Data Need to Feed</label> -->

  <!-- Input Wrapper -->
  <div class="flex items-center border border-gray-300 rounded-md px-3 py-2 space-x-3 focus-within:ring-2 focus-within:ring-blue-500 mt-4">
    
    <!-- Textarea -->
    <textarea rows="2" placeholder="Type your prompt or message here..." 
      class="flex-grow resize-none bg-transparent focus:outline-none text-gray-800"></textarea>

    <!-- File Upload Icon/Button -->
    <div class="relative">
      <input type="file" id="feedFile" class="hidden" />
      <label for="feedFile" class="cursor-pointer text-gray-500 hover:text-blue-600">
        📎
      </label>
    </div>
  </div>
</div>


    <!-- NEW: Enable Bot Persona & Design Checkbox -->
    <div class="border-t pt-6">
        <h4 class="text-lg font-semibold mb-4">Additional Features</h4>
        <div class="space-y-4">
            <label class="flex items-center cursor-pointer">
                <input type="checkbox" x-model="enablePersonaDesign" @change="updateTabVisibility()"
                    class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                <div class="ml-3">
                    <div class="text-sm font-medium text-gray-700">Enable Bot Persona & Design Customization</div>
                    <div class="text-xs text-gray-500">Allow custom branding, colors, icons, and personality settings for your bot</div>
                </div>
            </label>
        </div>
    </div>
</div>


                                <!-- Intents/Rules Tab -->
                                <div x-show="currentTab === 'intents'" class="space-y-6">


                                    <div class="main-container">
        <!-- Node Palette -->
        <div class="node-palette">
    <div class="palette-header">
        <input type="text" class="search-box" placeholder="Search by name" id="searchBox">
    </div>

    <div class="palette-content">
        <div class="node-category bg-gradient-to-br from-blue-50 to-gray-100 p-6 rounded-xl shadow-lg border border-blue-200 max-w-sm transition-all duration-300 hover:shadow-xl">
    <div class="category-title flex items-center gap-2 mb-4">
        <span class="text-2xl">🛠️</span>
        <h3 class="text-xl font-semibold text-gray-800">Add New Node</h3>
    </div>
    <div class="node-list space-y-2">
        <div class="palette-node flex items-center gap-4 p-4 bg-white rounded-lg shadow-md cursor-move hover:bg-indigo-50 hover:scale-105 transition-all duration-200" data-type="message" draggable="true">
            <div class="node-icon text-xl">🛠️</div>
            <div class="node-label font-medium text-gray-700">Create a new Node</div>
        </div>
    </div>
</div>  

        <div class="node-category">
            <div class="category-title">Input Fields</div>
            <div class="node-list">
                <div class="palette-node" data-type="question" draggable="true">
                    <div class="node-icon">❓</div>
                    <div class="node-label">Ask a question</div>
                </div>
                <div class="palette-node" data-type="date" draggable="true">
                    <div class="node-icon">📅</div>
                    <div class="node-label">Ask for a date</div>
                </div>
                <div class="palette-node" data-type="name" draggable="true">
                    <div class="node-icon">👤</div>
                    <div class="node-label">Ask for a name</div>
                </div>
                <div class="palette-node" data-type="number" draggable="true">
                    <div class="node-icon">🔢</div>
                    <div class="node-label">Ask for a number</div>
                </div>
                <div class="palette-node" data-type="phone" draggable="true">
                    <div class="node-icon">📱</div>
                    <div class="node-label">Ask for a phone</div>
                </div>
                <div class="palette-node" data-type="phone" draggable="true">
                    <div class="node-icon">🔘</div>
                    <div class="node-label">Buttons</div>
                </div>
                <div class="palette-node" data-type="url" draggable="true">
                    <div class="node-icon">🌐</div>
                    <div class="node-label">Ask for a Url</div>
                </div>
                <div class="palette-node" data-type="address" draggable="true">
                    <div class="node-icon">📍</div>
                    <div class="node-label">Ask for an address</div>
                </div>
                <div class="palette-node" data-type="autocomplete" draggable="true">
                    <div class="node-icon">😊</div>
                    <div class="node-label">Auto-complete</div>
                </div>
                <div class="component-section">
                    <div class="section-title">Logic Components</div>
                    
                    <div class="component-item" draggable="true" data-type="condition">
                        <div class="component-icon">🔀</div>
                        <div class="component-text">If-Else Condition</div>
                    </div>
                    
                    <div class="component-item" draggable="true" data-type="switch">
                        <div class="component-icon">🔄</div>
                        <div class="component-text">Switch Case</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <!-- Canvas Area -->
        <div class="canvas-area">
            <div class="canvas" id="canvas">
                <svg id="connectionsSvg">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1" />
                        </marker>
                    </defs>
                </svg>

                <!-- Starting Node -->
                <div class="starting-node" id="startingNode">
                    <div class="node-header">
                        <div class="node-type-icon">🚀</div>
                        <div class="node-title">Starting point</div>
                    </div>
                    <div class="node-content">Where your bot starts</div>
                    <div class="connection-point output-point" data-type="output"></div>
                </div>

                <div class="drop-zone" id="dropZone">
                    Drop your node here to add it to the flow
                </div>
            </div>

            <div class="mini-toolbar">
                <button class="mini-toolbar-btn" onclick="zoomIn()">🔍+</button>
                <button class="mini-toolbar-btn" onclick="resetZoom()">Reset</button>
                <button class="mini-toolbar-btn" onclick="zoomOut()">🔍-</button>
                <button class="mini-toolbar-btn" onclick="fitToScreen()">Fit</button>
            </div>

            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">-</button>
                <div class="zoom-level" id="zoomLevel">100%</div>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
            </div>
        </div>
    </div>

  <script>
        let nodeCounter = 0;
        let selectedNode = null;
        let connections = [];
        let isConnecting = false;
        let connectionStart = null;
        let tempLine = null;
        let dragOffset = { x: 0, y: 0 };
        let zoomLevel = 1;

        const canvas = document.getElementById('canvas');
        const svg = document.getElementById('connectionsSvg');
        const dropZone = document.getElementById('dropZone');
        const zoomLevelDisplay = document.getElementById('zoomLevel');

        // Node templates
        const nodeTemplates = {
            button: {
                title: 'Buttons',
                content: 'Show buttons for user interaction',
                icon: '🔘'
            },
            question: {
                title: 'Ask a question',
                content: 'Get text input from user',
                icon: '❓'
            },
            date: {
                title: 'Ask for a date',
                content: 'Date picker input',
                icon: '📅'
            },
            name: {
                title: 'Ask for a name',
                content: 'Text input for names',
                icon: '👤'
            },
            number: {
                title: 'Ask for a number',
                content: 'Numeric input field',
                icon: '🔢'
            },
            phone: {
                title: 'Ask for a phone',
                content: 'Phone number input',
                icon: '📱'
            },
            url: {
                title: 'Ask for a URL',
                content: 'URL input field',
                icon: '🌐'
            },
            address: {
                title: 'Ask for an address',
                content: 'Address input with validation',
                icon: '📍'
            },
            autocomplete: {
                title: 'Auto-complete',
                content: 'Dropdown with suggestions',
                icon: '😊'
            }
            autocomplete: {
                title: 'If-Else Condition',
                content: 'Conditional logic block',
                icon: '🔀'
            }
            autocomplete: {
                title: 'Switch Case',
                content: 'Switch-case logic block',
                icon: '🔁'
            }
        };

        // Setup drag and drop
        document.querySelectorAll('.palette-node').forEach(node => {
            node.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', node.dataset.type);
                node.classList.add('dragging');
            });

            node.addEventListener('dragend', (e) => {
                node.classList.remove('dragging');
            });
        });

        canvas.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('active');
        });

        canvas.addEventListener('dragleave', (e) => {
            if (!canvas.contains(e.relatedTarget)) {
                dropZone.classList.remove('active');
            }
        });

        canvas.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('active');
            
            const nodeType = e.dataTransfer.getData('text/plain');
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) / zoomLevel - 80;
            const y = (e.clientY - rect.top) / zoomLevel - 40;
            
            createNode(nodeType, x, y);
        });

        function createNode(type, x, y) {
            const template = nodeTemplates[type];
            const nodeId = ++nodeCounter;
            
            const node = document.createElement('div');
            node.className = `workflow-node ${type}-node`;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.dataset.id = nodeId;
            node.dataset.type = type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
            selectNode(node);
        }

        function makeNodeDraggable(node) {
            let isDragging = false;

            node.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('connection-point')) return;
                
                isDragging = true;
                selectNode(node);

                const rect = node.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                dragOffset.x = (e.clientX - rect.left) / zoomLevel;
                dragOffset.y = (e.clientY - rect.top) / zoomLevel;

                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging || selectedNode !== node) return;

                const canvasRect = canvas.getBoundingClientRect();
                const x = (e.clientX - canvasRect.left) / zoomLevel - dragOffset.x;
                const y = (e.clientY - canvasRect.top) / zoomLevel - dragOffset.y;

                node.style.left = Math.max(0, x) + 'px';
                node.style.top = Math.max(0, y) + 'px';

                updateConnections();
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && selectedNode === node) {
                    isDragging = false;
                }
            });
        }

        function selectNode(node) {
            // Remove selection from all nodes
            document.querySelectorAll('.workflow-node, .starting-node').forEach(n => {
                n.classList.remove('selected');
            });
            
            // Select the clicked node
            node.classList.add('selected');
            selectedNode = node;
        }

        function setupConnectionPoints(node) {
            const points = node.querySelectorAll('.connection-point');
            
            points.forEach(point => {
                point.addEventListener('mousedown', (e) => {
                    e.stopPropagation();
                    
                    if (!isConnecting && point.dataset.type === 'output') {
                        startConnection(point, node);
                    } else if (isConnecting && point.dataset.type === 'input') {
                        endConnection(point, node);
                    }
                });
            });
        }

        // Setup starting node
        const startingNode = document.getElementById('startingNode');
        makeNodeDraggable(startingNode);
        setupConnectionPoints(startingNode);

        function startConnection(point, node) {
            isConnecting = true;
            connectionStart = { point, node };
            
            const rect = point.getBoundingClientRect();
            const canvasRect = canvas.getBoundingClientRect();
            
            tempLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            tempLine.setAttribute('class', 'temp-connection');
            tempLine.setAttribute('x1', (rect.left - canvasRect.left + rect.width/2) / zoomLevel);
            tempLine.setAttribute('y1', (rect.top - canvasRect.top + rect.height/2) / zoomLevel);
            tempLine.setAttribute('x2', (rect.left - canvasRect.left + rect.width/2) / zoomLevel);
            tempLine.setAttribute('y2', (rect.top - canvasRect.top + rect.height/2) / zoomLevel);
            svg.appendChild(tempLine);
        }

        function endConnection(point, node) {
            if (!isConnecting || node === connectionStart.node) {
                cancelConnection();
                return;
            }

            // Create connection
            connections.push({
                from: connectionStart,
                to: { point, node },
                id: `conn_${Date.now()}`
            });

            if (tempLine) {
                svg.removeChild(tempLine);
                tempLine = null;
            }

            isConnecting = false;
            connectionStart = null;
            
            updateConnections();
        }

        function cancelConnection() {
            isConnecting = false;
            connectionStart = null;
            
            if (tempLine) {
                svg.removeChild(tempLine);
                tempLine = null;
            }
        }

        // Update temp line during connection
        canvas.addEventListener('mousemove', (e) => {
            if (isConnecting && tempLine) {
                const canvasRect = canvas.getBoundingClientRect();
                tempLine.setAttribute('x2', (e.clientX - canvasRect.left) / zoomLevel);
                tempLine.setAttribute('y2', (e.clientY - canvasRect.top) / zoomLevel);
            }
        });

        // Cancel connection on right click
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            if (isConnecting) {
                cancelConnection();
            }
        });

        function updateConnections() {
            // Clear existing connection paths
            const existingPaths = svg.querySelectorAll('.connection-path');
            existingPaths.forEach(path => path.remove());

            connections.forEach(conn => {
                const fromRect = conn.from.point.getBoundingClientRect();
                const toRect = conn.to.point.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();

                const x1 = (fromRect.left - canvasRect.left + fromRect.width/2) / zoomLevel;
                const y1 = (fromRect.top - canvasRect.top + fromRect.height/2) / zoomLevel;
                const x2 = (toRect.left - canvasRect.left + toRect.width/2) / zoomLevel;
                const y2 = (toRect.top - canvasRect.top + toRect.height/2) / zoomLevel;

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                const midX = (x1 + x2) / 2;
                
                const d = `M ${x1} ${y1} C ${midX} ${y1}, ${midX} ${y2}, ${x2} ${y2}`;
                
                path.setAttribute('d', d);
                path.setAttribute('class', 'connection-path');
                path.setAttribute('marker-end', 'url(#arrowhead)');
                
                svg.appendChild(path);
            });
        }

        // Zoom functionality
        function zoomIn() {
            zoomLevel = Math.min(zoomLevel * 1.2, 3);
            updateZoom();
        }

        function zoomOut() {
            zoomLevel = Math.max(zoomLevel / 1.2, 0.3);
            updateZoom();
        }

        function resetZoom() {
            zoomLevel = 1;
            updateZoom();
        }

        function fitToScreen() {
            const nodes = canvas.querySelectorAll('.workflow-node, .starting-node');
            if (nodes.length === 0) return;

            let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
            
            nodes.forEach(node => {
                const rect = node.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                const x = (rect.left - canvasRect.left) / zoomLevel;
                const y = (rect.top - canvasRect.top) / zoomLevel;
                
                minX = Math.min(minX, x);
                minY = Math.min(minY, y);
                maxX = Math.max(maxX, x + node.offsetWidth);
                maxY = Math.max(maxY, y + node.offsetHeight);
            });

            const width = maxX - minX;
            const height = maxY - minY;
            const canvasWidth = canvas.offsetWidth;
            const canvasHeight = canvas.offsetHeight;

            const scaleX = canvasWidth / (width + 200);
            const scaleY = canvasHeight / (height + 200);
            
            zoomLevel = Math.min(scaleX, scaleY, 1);
            updateZoom();
        }

        function updateZoom() {
            canvas.style.transform = `scale(${zoomLevel})`;
            canvas.style.transformOrigin = 'top left';
            zoomLevelDisplay.textContent = Math.round(zoomLevel * 100) + '%';
            updateConnections();
        }

        // Search functionality
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const nodes = document.querySelectorAll('.palette-node');
            
            nodes.forEach(node => {
                const label = node.querySelector('.node-label').textContent.toLowerCase();
                if (label.includes(searchTerm)) {
                    node.style.display = 'flex';
                } else {
                    node.style.display = 'none';
                }
            });
        });

        // Delete selected node with Delete key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Delete' && selectedNode && selectedNode.id !== 'startingNode') {
                // Remove connections involving this node
                connections = connections.filter(conn => 
                    conn.from.node !== selectedNode && conn.to.node !== selectedNode
                );
                
                // Remove the node
                selectedNode.remove();
                selectedNode = null;
                updateConnections();
            }
        });

        // Clear canvas on Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (isConnecting) {
                    cancelConnection();
                } else if (selectedNode) {
                    selectedNode.classList.remove('selected');
                    selectedNode = null;
                }
            }
        });

        // Auto-connect new nodes to previous ones
        let lastCreatedNode = null;

        function createNode(type, x, y) {
            const template = nodeTemplates[type];
            const nodeId = ++nodeCounter;
            
            const node = document.createElement('div');
            node.className = `workflow-node ${type}-node`;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.dataset.id = nodeId;
            node.dataset.type = type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
            selectNode(node);

            // Auto-connect to the last created node or starting node
            if (lastCreatedNode) {
                autoConnect(lastCreatedNode, node);
            } else {
                // Connect to starting node if this is the first node
                const startingNode = document.getElementById('startingNode');
                autoConnect(startingNode, node);
            }

            lastCreatedNode = node;
        }

        function autoConnect(fromNode, toNode) {
            const fromPoint = fromNode.querySelector('.output-point');
            const toPoint = toNode.querySelector('.input-point');
            
            if (fromPoint && toPoint) {
                connections.push({
                    from: { point: fromPoint, node: fromNode },
                    to: { point: toPoint, node: toNode },
                    id: `conn_${Date.now()}`
                });
                updateConnections();
            }
        }

        // Initialize with proper event handling
        document.addEventListener('DOMContentLoaded', () => {
            updateZoom();
            
            // Add some sample connections for demo
            setTimeout(() => {
                // Example: Create a sample flow
                // This is just for demonstration
            }, 1000);
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            updateConnections();
        });

        // Mini toolbar functionality
        function clearCanvas() {
            const nodes = canvas.querySelectorAll('.workflow-node');
            nodes.forEach(node => node.remove());
            connections = [];
            updateConnections();
            nodeCounter = 0;
            lastCreatedNode = null;
            selectedNode = null;
        }

        // Add context menu for nodes
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            
            const node = e.target.closest('.workflow-node');
            if (node && node.id !== 'startingNode') {
                showContextMenu(e.clientX, e.clientY, node);
            }
        });

        function showContextMenu(x, y, node) {
            // Create context menu
            const contextMenu = document.createElement('div');
            contextMenu.style.cssText = `
                position: fixed;
                top: ${y}px;
                left: ${x}px;
                background: white;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                min-width: 150px;
            `;

            contextMenu.innerHTML = `
                <div style="padding: 8px 0;">
                    <div class="context-menu-item" onclick="duplicateNode('${node.dataset.id}')">
                        <span>📋</span> Duplicate
                    </div>
                    <div class="context-menu-item" onclick="deleteNode('${node.dataset.id}')">
                        <span>🗑️</span> Delete
                    </div>
                    <div class="context-menu-item" onclick="editNode('${node.dataset.id}')">
                        <span>✏️</span> Edit
                    </div>
                </div>
            `;

            // Add context menu styles
            const style = document.createElement('style');
            style.textContent = `
                .context-menu-item {
                    padding: 8px 16px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: #374151;
                }
                .context-menu-item:hover {
                    background: #f3f4f6;
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(contextMenu);

            // Remove on click outside
            setTimeout(() => {
                document.addEventListener('click', () => {
                    contextMenu.remove();
                    style.remove();
                }, { once: true });
            }, 0);
        }

        function duplicateNode(nodeId) {
            const originalNode = document.querySelector(`[data-id="${nodeId}"]`);
            if (originalNode) {
                const rect = originalNode.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                const x = (rect.left - canvasRect.left) / zoomLevel + 50;
                const y = (rect.top - canvasRect.top) / zoomLevel + 50;
                
                createNode(originalNode.dataset.type, x, y);
            }
        }

        function deleteNode(nodeId) {
            const node = document.querySelector(`[data-id="${nodeId}"]`);
            if (node) {
                // Remove connections
                connections = connections.filter(conn => 
                    conn.from.node !== node && conn.to.node !== node
                );
                
                // Remove node
                node.remove();
                if (selectedNode === node) {
                    selectedNode = null;
                }
                updateConnections();
            }
        }

        function editNode(nodeId) {
            const node = document.querySelector(`[data-id="${nodeId}"]`);
            if (node) {
                selectNode(node);
                // Here you would typically open a properties panel
                console.log('Edit node:', node.dataset.type);
            }
        }

        // Save/Load functionality (localStorage)
        function saveWorkflow() {
            const workflow = {
                nodes: Array.from(canvas.querySelectorAll('.workflow-node')).map(node => ({
                    id: node.dataset.id,
                    type: node.dataset.type,
                    x: parseInt(node.style.left),
                    y: parseInt(node.style.top)
                })),
                connections: connections.map(conn => ({
                    from: conn.from.node.dataset.id,
                    to: conn.to.node.dataset.id
                })),
                zoom: zoomLevel
            };
            
            localStorage.setItem('botWorkflow', JSON.stringify(workflow));
            console.log('Workflow saved!');
        }

        function loadWorkflow() {
            const saved = localStorage.getItem('botWorkflow');
            if (saved) {
                const workflow = JSON.parse(saved);
                
                // Clear existing
                clearCanvas();
                
                // Recreate nodes
                workflow.nodes.forEach(nodeData => {
                    createNodeFromData(nodeData);
                });
                
                // Recreate connections (simplified)
                setTimeout(() => {
                    workflow.connections.forEach(connData => {
                        const fromNode = document.querySelector(`[data-id="${connData.from}"]`);
                        const toNode = document.querySelector(`[data-id="${connData.to}"]`);
                        if (fromNode && toNode) {
                            autoConnect(fromNode, toNode);
                        }
                    });
                }, 100);
                
                zoomLevel = workflow.zoom || 1;
                updateZoom();
            }
        }

        function createNodeFromData(nodeData) {
            nodeCounter = Math.max(nodeCounter, parseInt(nodeData.id));
            const template = nodeTemplates[nodeData.type];
            
            const node = document.createElement('div');
            node.className = `workflow-node ${nodeData.type}-node`;
            node.style.left = nodeData.x + 'px';
            node.style.top = nodeData.y + 'px';
            node.dataset.id = nodeData.id;
            node.dataset.type = nodeData.type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveWorkflow();
                        break;
                    case 'o':
                        e.preventDefault();
                        loadWorkflow();
                        break;
                    case 'z':
                        e.preventDefault();
                        // Undo functionality could be implemented here
                        break;
                }
            }
        });
    </script>                                 
</div>

          <div x-show="currentTab === 'hybrid'" class="space-y-6">


                                    <div class="main-container">
        <!-- Node Palette -->
        <div class="node-palette">
    <div class="palette-header">
        <input type="text" class="search-box" placeholder="Search by name" id="searchBox">
    </div>

    <div class="palette-content">
        <div class="node-category bg-gradient-to-br from-blue-50 to-gray-100 p-6 rounded-xl shadow-lg border border-blue-200 max-w-sm transition-all duration-300 hover:shadow-xl">
    <div class="category-title flex items-center gap-2 mb-4">
        <span class="text-2xl">🛠️</span>
        <h3 class="text-xl font-semibold text-gray-800">Add New Node</h3>
    </div>
    <div class="node-list space-y-2">
        <div class="palette-node flex items-center gap-4 p-4 bg-white rounded-lg shadow-md cursor-move hover:bg-indigo-50 hover:scale-105 transition-all duration-200" data-type="message" draggable="true">
            <div class="node-icon text-xl">🛠️</div>
            <div class="node-label font-medium text-gray-700">Create a new Node</div>
        </div>
    </div>
</div>

        <div class="node-category">
            <div class="category-title">Input Fields</div>
            <div class="node-list">
                <div class="palette-node" data-type="question" draggable="true">
                    <div class="node-icon">❓</div>
                    <div class="node-label">Ask a answer</div>
                </div>
                <div class="palette-node" data-type="AI Agent" draggable="true">
                    <div class="node-icon">🤖</div>
                    <div class="node-label">AI Agent</div>
                </div>
                <div class="palette-node" data-type="AI Agent" draggable="true">
                    <div class="node-icon">✨</div>
                    <div class="node-label">LLM Model</div>
                </div>
                <div class="palette-node" data-type="date" draggable="true">
                    <div class="node-icon">📅</div>
                    <div class="node-label">Ask for a date</div>
                </div>
                <div class="palette-node" data-type="name" draggable="true">
                    <div class="node-icon">👤</div>
                    <div class="node-label">Ask for a name</div>
                </div>
                <div class="palette-node" data-type="number" draggable="true">
                    <div class="node-icon">🔢</div>
                    <div class="node-label">Ask for a number</div>
                </div>
                <div class="palette-node" data-type="phone" draggable="true">
                    <div class="node-icon">📱</div>
                    <div class="node-label">Ask for a phone</div>
                </div>
                <div class="palette-node" data-type="phone" draggable="true">
                    <div class="node-icon">🔘</div>
                    <div class="node-label">Buttons</div>
                </div>
                <div class="palette-node" data-type="url" draggable="true">
                    <div class="node-icon">🌐</div>
                    <div class="node-label">Ask for a Url</div>
                </div>
                <div class="palette-node" data-type="address" draggable="true">
                    <div class="node-icon">📍</div>
                    <div class="node-label">Ask for an address</div>
                </div>
                <div class="palette-node" data-type="autocomplete" draggable="true">
                    <div class="node-icon">😊</div>
                    <div class="node-label">Auto-complete</div>
                </div>

            </div>
        </div>
    </div>
</div>

        <!-- Canvas Area -->
        <div class="canvas-area">
            <div class="canvas" id="canvas">
                <svg id="connectionsSvg">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1" />
                        </marker>
                    </defs>
                </svg>

                <!-- Starting Node -->
                <div class="starting-node" id="startingNode">
                    <div class="node-header">
                        <div class="node-type-icon">🚀</div>
                        <div class="node-title">Starting point</div>
                    </div>
                    <div class="node-content">Where your bot starts</div>
                    <div class="connection-point output-point" data-type="output"></div>
                </div>

                <div class="drop-zone" id="dropZone">
                    Drop your node here to add it to the flow
                </div>
            </div>

            <div class="mini-toolbar">
                <button class="mini-toolbar-btn" onclick="zoomIn()">🔍+</button>
                <button class="mini-toolbar-btn" onclick="resetZoom()">Reset</button>
                <button class="mini-toolbar-btn" onclick="zoomOut()">🔍-</button>
                <button class="mini-toolbar-btn" onclick="fitToScreen()">Fit</button>
            </div>

            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">-</button>
                <div class="zoom-level" id="zoomLevel">100%</div>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
            </div>
        </div>
    </div>
    <script>
        let nodeCounter = 0;
        let selectedNode = null;
        let connections = [];
        let isConnecting = false;
        let connectionStart = null;
        let tempLine = null;
        let dragOffset = { x: 0, y: 0 };
        let zoomLevel = 1;

        const canvas = document.getElementById('canvas');
        const svg = document.getElementById('connectionsSvg');
        const dropZone = document.getElementById('dropZone');
        const zoomLevelDisplay = document.getElementById('zoomLevel');

        // Node templates
        const nodeTemplates = {
            button: {
                title: 'Buttons',
                content: 'Show buttons for user interaction',
                icon: '🔘'
            },
            question: {
                title: 'Ask a question',
                content: 'Get text input from user',
                icon: '❓'
            },
            date: {
                title: 'Ask for a date',
                content: 'Date picker input',
                icon: '📅'
            },
            name: {
                title: 'Ask for a name',
                content: 'Text input for names',
                icon: '👤'
            },
            number: {
                title: 'Ask for a number',
                content: 'Numeric input field',
                icon: '🔢'
            },
            phone: {
                title: 'Ask for a phone',
                content: 'Phone number input',
                icon: '📱'
            },
            url: {
                title: 'Ask for a URL',
                content: 'URL input field',
                icon: '🌐'
            },
            address: {
                title: 'Ask for an address',
                content: 'Address input with validation',
                icon: '📍'
            },
            autocomplete: {
                title: 'Auto-complete',
                content: 'Dropdown with suggestions',
                icon: '😊'
            }
        };

        // Setup drag and drop
        document.querySelectorAll('.palette-node').forEach(node => {
            node.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', node.dataset.type);
                node.classList.add('dragging');
            });

            node.addEventListener('dragend', (e) => {
                node.classList.remove('dragging');
            });
        });

        canvas.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('active');
        });

        canvas.addEventListener('dragleave', (e) => {
            if (!canvas.contains(e.relatedTarget)) {
                dropZone.classList.remove('active');
            }
        });

        canvas.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('active');
            
            const nodeType = e.dataTransfer.getData('text/plain');
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) / zoomLevel - 80;
            const y = (e.clientY - rect.top) / zoomLevel - 40;
            
            createNode(nodeType, x, y);
        });

        function createNode(type, x, y) {
            const template = nodeTemplates[type];
            const nodeId = ++nodeCounter;
            
            const node = document.createElement('div');
            node.className = `workflow-node ${type}-node`;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.dataset.id = nodeId;
            node.dataset.type = type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
            selectNode(node);
        }

        function makeNodeDraggable(node) {
            let isDragging = false;

            node.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('connection-point')) return;
                
                isDragging = true;
                selectNode(node);

                const rect = node.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                dragOffset.x = (e.clientX - rect.left) / zoomLevel;
                dragOffset.y = (e.clientY - rect.top) / zoomLevel;

                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging || selectedNode !== node) return;

                const canvasRect = canvas.getBoundingClientRect();
                const x = (e.clientX - canvasRect.left) / zoomLevel - dragOffset.x;
                const y = (e.clientY - canvasRect.top) / zoomLevel - dragOffset.y;

                node.style.left = Math.max(0, x) + 'px';
                node.style.top = Math.max(0, y) + 'px';

                updateConnections();
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && selectedNode === node) {
                    isDragging = false;
                }
            });
        }

        function selectNode(node) {
            // Remove selection from all nodes
            document.querySelectorAll('.workflow-node, .starting-node').forEach(n => {
                n.classList.remove('selected');
            });
            
            // Select the clicked node
            node.classList.add('selected');
            selectedNode = node;
        }

        function setupConnectionPoints(node) {
            const points = node.querySelectorAll('.connection-point');
            
            points.forEach(point => {
                point.addEventListener('mousedown', (e) => {
                    e.stopPropagation();
                    
                    if (!isConnecting && point.dataset.type === 'output') {
                        startConnection(point, node);
                    } else if (isConnecting && point.dataset.type === 'input') {
                        endConnection(point, node);
                    }
                });
            });
        }

        // Setup starting node
        const startingNode = document.getElementById('startingNode');
        makeNodeDraggable(startingNode);
        setupConnectionPoints(startingNode);

        function startConnection(point, node) {
            isConnecting = true;
            connectionStart = { point, node };
            
            const rect = point.getBoundingClientRect();
            const canvasRect = canvas.getBoundingClientRect();
            
            tempLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            tempLine.setAttribute('class', 'temp-connection');
            tempLine.setAttribute('x1', (rect.left - canvasRect.left + rect.width/2) / zoomLevel);
            tempLine.setAttribute('y1', (rect.top - canvasRect.top + rect.height/2) / zoomLevel);
            tempLine.setAttribute('x2', (rect.left - canvasRect.left + rect.width/2) / zoomLevel);
            tempLine.setAttribute('y2', (rect.top - canvasRect.top + rect.height/2) / zoomLevel);
            svg.appendChild(tempLine);
        }

        function endConnection(point, node) {
            if (!isConnecting || node === connectionStart.node) {
                cancelConnection();
                return;
            }

            // Create connection
            connections.push({
                from: connectionStart,
                to: { point, node },
                id: `conn_${Date.now()}`
            });

            if (tempLine) {
                svg.removeChild(tempLine);
                tempLine = null;
            }

            isConnecting = false;
            connectionStart = null;
            
            updateConnections();
        }

        function cancelConnection() {
            isConnecting = false;
            connectionStart = null;
            
            if (tempLine) {
                svg.removeChild(tempLine);
                tempLine = null;
            }
        }

        // Update temp line during connection
        canvas.addEventListener('mousemove', (e) => {
            if (isConnecting && tempLine) {
                const canvasRect = canvas.getBoundingClientRect();
                tempLine.setAttribute('x2', (e.clientX - canvasRect.left) / zoomLevel);
                tempLine.setAttribute('y2', (e.clientY - canvasRect.top) / zoomLevel);
            }
        });

        // Cancel connection on right click
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            if (isConnecting) {
                cancelConnection();
            }
        });

        function updateConnections() {
            // Clear existing connection paths
            const existingPaths = svg.querySelectorAll('.connection-path');
            existingPaths.forEach(path => path.remove());

            connections.forEach(conn => {
                const fromRect = conn.from.point.getBoundingClientRect();
                const toRect = conn.to.point.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();

                const x1 = (fromRect.left - canvasRect.left + fromRect.width/2) / zoomLevel;
                const y1 = (fromRect.top - canvasRect.top + fromRect.height/2) / zoomLevel;
                const x2 = (toRect.left - canvasRect.left + toRect.width/2) / zoomLevel;
                const y2 = (toRect.top - canvasRect.top + toRect.height/2) / zoomLevel;

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                const midX = (x1 + x2) / 2;
                
                const d = `M ${x1} ${y1} C ${midX} ${y1}, ${midX} ${y2}, ${x2} ${y2}`;
                
                path.setAttribute('d', d);
                path.setAttribute('class', 'connection-path');
                path.setAttribute('marker-end', 'url(#arrowhead)');
                
                svg.appendChild(path);
            });
        }

        // Zoom functionality
        function zoomIn() {
            zoomLevel = Math.min(zoomLevel * 1.2, 3);
            updateZoom();
        }

        function zoomOut() {
            zoomLevel = Math.max(zoomLevel / 1.2, 0.3);
            updateZoom();
        }

        function resetZoom() {
            zoomLevel = 1;
            updateZoom();
        }

        function fitToScreen() {
            const nodes = canvas.querySelectorAll('.workflow-node, .starting-node');
            if (nodes.length === 0) return;

            let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
            
            nodes.forEach(node => {
                const rect = node.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                const x = (rect.left - canvasRect.left) / zoomLevel;
                const y = (rect.top - canvasRect.top) / zoomLevel;
                
                minX = Math.min(minX, x);
                minY = Math.min(minY, y);
                maxX = Math.max(maxX, x + node.offsetWidth);
                maxY = Math.max(maxY, y + node.offsetHeight);
            });

            const width = maxX - minX;
            const height = maxY - minY;
            const canvasWidth = canvas.offsetWidth;
            const canvasHeight = canvas.offsetHeight;

            const scaleX = canvasWidth / (width + 200);
            const scaleY = canvasHeight / (height + 200);
            
            zoomLevel = Math.min(scaleX, scaleY, 1);
            updateZoom();
        }

        function updateZoom() {
            canvas.style.transform = `scale(${zoomLevel})`;
            canvas.style.transformOrigin = 'top left';
            zoomLevelDisplay.textContent = Math.round(zoomLevel * 100) + '%';
            updateConnections();
        }

        // Search functionality
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const nodes = document.querySelectorAll('.palette-node');
            
            nodes.forEach(node => {
                const label = node.querySelector('.node-label').textContent.toLowerCase();
                if (label.includes(searchTerm)) {
                    node.style.display = 'flex';
                } else {
                    node.style.display = 'none';
                }
            });
        });

        // Delete selected node with Delete key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Delete' && selectedNode && selectedNode.id !== 'startingNode') {
                // Remove connections involving this node
                connections = connections.filter(conn => 
                    conn.from.node !== selectedNode && conn.to.node !== selectedNode
                );
                
                // Remove the node
                selectedNode.remove();
                selectedNode = null;
                updateConnections();
            }
        });

        // Clear canvas on Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (isConnecting) {
                    cancelConnection();
                } else if (selectedNode) {
                    selectedNode.classList.remove('selected');
                    selectedNode = null;
                }
            }
        });

        // Auto-connect new nodes to previous ones
        let lastCreatedNode = null;

        function createNode(type, x, y) {
            const template = nodeTemplates[type];
            const nodeId = ++nodeCounter;
            
            const node = document.createElement('div');
            node.className = `workflow-node ${type}-node`;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.dataset.id = nodeId;
            node.dataset.type = type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
            selectNode(node);

            // Auto-connect to the last created node or starting node
            if (lastCreatedNode) {
                autoConnect(lastCreatedNode, node);
            } else {
                // Connect to starting node if this is the first node
                const startingNode = document.getElementById('startingNode');
                autoConnect(startingNode, node);
            }

            lastCreatedNode = node;
        }

        function autoConnect(fromNode, toNode) {
            const fromPoint = fromNode.querySelector('.output-point');
            const toPoint = toNode.querySelector('.input-point');
            
            if (fromPoint && toPoint) {
                connections.push({
                    from: { point: fromPoint, node: fromNode },
                    to: { point: toPoint, node: toNode },
                    id: `conn_${Date.now()}`
                });
                updateConnections();
            }
        }

        // Initialize with proper event handling
        document.addEventListener('DOMContentLoaded', () => {
            updateZoom();
            
            // Add some sample connections for demo
            setTimeout(() => {
                // Example: Create a sample flow
                // This is just for demonstration
            }, 1000);
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            updateConnections();
        });

        // Mini toolbar functionality
        function clearCanvas() {
            const nodes = canvas.querySelectorAll('.workflow-node');
            nodes.forEach(node => node.remove());
            connections = [];
            updateConnections();
            nodeCounter = 0;
            lastCreatedNode = null;
            selectedNode = null;
        }

        // Add context menu for nodes
        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            
            const node = e.target.closest('.workflow-node');
            if (node && node.id !== 'startingNode') {
                showContextMenu(e.clientX, e.clientY, node);
            }
        });

        function showContextMenu(x, y, node) {
            // Create context menu
            const contextMenu = document.createElement('div');
            contextMenu.style.cssText = `
                position: fixed;
                top: ${y}px;
                left: ${x}px;
                background: white;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                min-width: 150px;
            `;

            contextMenu.innerHTML = `
                <div style="padding: 8px 0;">
                    <div class="context-menu-item" onclick="duplicateNode('${node.dataset.id}')">
                        <span>📋</span> Duplicate
                    </div>
                    <div class="context-menu-item" onclick="deleteNode('${node.dataset.id}')">
                        <span>🗑️</span> Delete
                    </div>
                    <div class="context-menu-item" onclick="editNode('${node.dataset.id}')">
                        <span>✏️</span> Edit
                    </div>
                </div>
            `;

            // Add context menu styles
            const style = document.createElement('style');
            style.textContent = `
                .context-menu-item {
                    padding: 8px 16px;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-size: 14px;
                    color: #374151;
                }
                .context-menu-item:hover {
                    background: #f3f4f6;
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(contextMenu);

            // Remove on click outside
            setTimeout(() => {
                document.addEventListener('click', () => {
                    contextMenu.remove();
                    style.remove();
                }, { once: true });
            }, 0);
        }

        function duplicateNode(nodeId) {
            const originalNode = document.querySelector(`[data-id="${nodeId}"]`);
            if (originalNode) {
                const rect = originalNode.getBoundingClientRect();
                const canvasRect = canvas.getBoundingClientRect();
                const x = (rect.left - canvasRect.left) / zoomLevel + 50;
                const y = (rect.top - canvasRect.top) / zoomLevel + 50;
                
                createNode(originalNode.dataset.type, x, y);
            }
        }

        function deleteNode(nodeId) {
            const node = document.querySelector(`[data-id="${nodeId}"]`);
            if (node) {
                // Remove connections
                connections = connections.filter(conn => 
                    conn.from.node !== node && conn.to.node !== node
                );
                
                // Remove node
                node.remove();
                if (selectedNode === node) {
                    selectedNode = null;
                }
                updateConnections();
            }
        }

        function editNode(nodeId) {
            const node = document.querySelector(`[data-id="${nodeId}"]`);
            if (node) {
                selectNode(node);
                // Here you would typically open a properties panel
                console.log('Edit node:', node.dataset.type);
            }
        }

        // Save/Load functionality (localStorage)
        function saveWorkflow() {
            const workflow = {
                nodes: Array.from(canvas.querySelectorAll('.workflow-node')).map(node => ({
                    id: node.dataset.id,
                    type: node.dataset.type,
                    x: parseInt(node.style.left),
                    y: parseInt(node.style.top)
                })),
                connections: connections.map(conn => ({
                    from: conn.from.node.dataset.id,
                    to: conn.to.node.dataset.id
                })),
                zoom: zoomLevel
            };
            
            localStorage.setItem('botWorkflow', JSON.stringify(workflow));
            console.log('Workflow saved!');
        }

        function loadWorkflow() {
            const saved = localStorage.getItem('botWorkflow');
            if (saved) {
                const workflow = JSON.parse(saved);
                
                // Clear existing
                clearCanvas();
                
                // Recreate nodes
                workflow.nodes.forEach(nodeData => {
                    createNodeFromData(nodeData);
                });
                
                // Recreate connections (simplified)
                setTimeout(() => {
                    workflow.connections.forEach(connData => {
                        const fromNode = document.querySelector(`[data-id="${connData.from}"]`);
                        const toNode = document.querySelector(`[data-id="${connData.to}"]`);
                        if (fromNode && toNode) {
                            autoConnect(fromNode, toNode);
                        }
                    });
                }, 100);
                
                zoomLevel = workflow.zoom || 1;
                updateZoom();
            }
        }

        function createNodeFromData(nodeData) {
            nodeCounter = Math.max(nodeCounter, parseInt(nodeData.id));
            const template = nodeTemplates[nodeData.type];
            
            const node = document.createElement('div');
            node.className = `workflow-node ${nodeData.type}-node`;
            node.style.left = nodeData.x + 'px';
            node.style.top = nodeData.y + 'px';
            node.dataset.id = nodeData.id;
            node.dataset.type = nodeData.type;

            node.innerHTML = `
                <div class="node-header">
                    <div class="node-type-icon">${template.icon}</div>
                    <div class="node-title">${template.title}</div>
                </div>
                <div class="node-content">${template.content}</div>
                <div class="connection-point input-point" data-type="input"></div>
                <div class="connection-point output-point" data-type="output"></div>
            `;

            canvas.appendChild(node);
            makeNodeDraggable(node);
            setupConnectionPoints(node);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveWorkflow();
                        break;
                    case 'o':
                        e.preventDefault();
                        loadWorkflow();
                        break;
                    case 'z':
                        e.preventDefault();
                        // Undo functionality could be implemented here
                        break;
                }
            }
        });
    </script>
                                  
</div>
                                <!-- AI Configuration Tab -->
                                <div x-show="currentTab === 'ai-config'" class="space-y-6">
                                    <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                                        <h4 class="font-semibold text-purple-800 mb-2">AI Model Settings</h4>
                                        <p class="text-purple-700 text-sm">Fine-tune your AI model's behavior and response characteristics.</p>
                                    </div>

                                    <!-- Model Selection -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">AI Model</label>
                                        <select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option>GPT-4 (Recommended)</option>
                                            <option>GPT-3.5 Turbo</option>
                                            <option>Claude 3.5</option>
                                            <option>Custom Model</option>
                                        </select>
                                    </div>

                                    <!-- Temperature Control -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">
                                            Creativity (Temperature): <span x-text="temperature"></span>
                                        </label>
                                        <input type="range" x-model="temperature" min="0" max="2" step="0.1" 
                                            class="w-full h-2 bg-gray-200 rounded-lg cursor-pointer">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Focused (0.0)</span>
                                            <span>Balanced (1.0)</span>
                                            <span>Creative (2.0)</span>
                                        </div>
                                    </div>

                                    <!-- Max Tokens -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">
                                            Max Response Length: <span x-text="maxTokens"></span> tokens
                                        </label>
                                        <input type="range" x-model="maxTokens" min="50" max="4000" step="50" 
                                            class="w-full h-2 bg-gray-200 rounded-lg cursor-pointer">
                                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                                            <span>Short (50)</span>
                                            <span>Medium (150)</span>
                                            <span>Long (4000)</span>
                                        </div>
                                    </div>

                                    <!-- Context Settings -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-3">Memory & Context</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="radio" name="context" value="stateless" class="mr-2">
                                                <span class="text-sm">Reset every turn (Stateless)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="context" value="persistent" class="mr-2" checked>
                                                <span class="text-sm">Persistent memory (Maintains conversation history)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="context" value="sliding" class="mr-2">
                                                <span class="text-sm">Sliding window (Last 10 messages)</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Enhanced Bot Persona & Design Tab -->
                                <div x-show="currentTab === 'persona'" class="space-y-6">
                                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                        <h4 class="font-semibold text-green-800 mb-2">Bot Personality & Design</h4>
                                        <p class="text-green-700 text-sm">Choose a persona preset with its default design, or create a custom look.</p>
                                    </div>

                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                        <!-- Left Column: Persona Selection & Customization -->
                                        <div class="space-y-6">
                                            <!-- Persona Presets with Default Designs -->
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-3">Choose a Persona Preset</label>
                                                <div class="space-y-3">
                                                    <template x-for="(design, key) in personaDesigns" :key="key">
                                                        <div @click="selectPersona(key)" 
                                                            :class="selectedPersona === key ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'"
                                                            class="border-2 rounded-lg p-4 cursor-pointer transition-colors">
                                                            <div class="flex items-center justify-between mb-2">
                                                                <div class="flex items-center">
                                                                    <input type="radio" :checked="selectedPersona === key" class="mr-3">
                                                                    <div class="flex items-center">
                                                                        <i :class="design.icon" class="text-lg mr-3" :style="`color: ${design.colors.primary}`"></i>
                                                                        <div>
                                                                            <h5 class="font-medium" x-text="design.name"></h5>
                                                                            <p class="text-xs text-gray-500" x-text="design.description"></p>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="text-xs text-gray-400">DEFAULT</div>
                                                            </div>
                                                            <!-- Color Preview -->
                                                            <div class="flex space-x-2 mt-2">
                                                                <div class="w-4 h-4 rounded-full border" :style="`background-color: ${design.colors.primary}`"></div>
                                                                <div class="w-4 h-4 rounded-full border" :style="`background-color: ${design.colors.secondary}`"></div>
                                                                <div class="w-4 h-4 rounded-full border" :style="`background-color: ${design.colors.accent}`"></div>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    
                                                    <!-- Pro Design Option -->
                                                    <div @click="selectedDesign = 'pro'" 
                                                        :class="selectedDesign === 'pro' ? 'border-purple-500 bg-purple-50' : 'border-gray-200 hover:border-gray-300'"
                                                        class="border-2 rounded-lg p-4 cursor-pointer transition-colors">
                                                        <div class="flex items-center justify-between mb-2">
                                                            <div class="flex items-center">
                                                                <input type="radio" :checked="selectedDesign === 'pro'" class="mr-3">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-crown text-lg mr-3 text-purple-600"></i>
                                                                    <div>
                                                                        <h5 class="font-medium">Custom Pro Design</h5>
                                                                        <p class="text-xs text-gray-500">Full customization with advanced options</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">PRO</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Design Customization (Show when Pro is selected or a persona is selected) -->
                                            <div x-show="selectedDesign === 'pro' || selectedPersona" class="border-t pt-6">
                                                <h4 class="text-lg font-semibold mb-4">Customize Design</h4>
                                                
                                                <!-- Color Customization -->
                                                <div class="space-y-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                                                        <div class="flex items-center space-x-3">
                                                            <input type="color" x-model="customColors.primary" @change="updatePreview()"
                                                                class="color-picker">
                                                            <span class="text-sm font-mono" x-text="customColors.primary"></span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">Secondary Color</label>
                                                        <div class="flex items-center space-x-3">
                                                            <input type="color" x-model="customColors.secondary" @change="updatePreview()"
                                                                class="color-picker">
                                                            <span class="text-sm font-mono" x-text="customColors.secondary"></span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                                                        <div class="flex items-center space-x-3">
                                                            <input type="color" x-model="customColors.accent" @change="updatePreview()"
                                                                class="color-picker">
                                                            <span class="text-sm font-mono" x-text="customColors.accent"></span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Icon Selection -->
                                                <div class="mt-6">
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Bot Icon</label>
                                                    <div class="grid grid-cols-6 gap-3">
                                                        <template x-for="icon in ['fas fa-robot', 'fas fa-headset', 'fas fa-user-tie', 'fas fa-graduation-cap', 'fas fa-smile', 'fas fa-briefcase', 'fas fa-heart', 'fas fa-star', 'fas fa-thumbs-up', 'fas fa-lightbulb', 'fas fa-rocket', 'fas fa-shield-alt']">
                                                            <div @click="selectedIcon = icon; updatePreview()" 
                                                                :class="selectedIcon === icon ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'"
                                                                class="border-2 rounded-lg p-3 text-center cursor-pointer transition-colors">
                                                                <i :class="icon" class="text-xl" :style="`color: ${customColors.primary}`"></i>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>

                                                <!-- Style Options -->
                                                <div class="mt-6 space-y-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">Border Radius</label>
                                                        <select x-model="borderRadius" @change="updatePreview()" 
                                                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                                            <option value="rounded-none">Square</option>
                                                            <option value="rounded-md">Slightly Rounded</option>
                                                            <option value="rounded-lg">Rounded</option>
                                                            <option value="rounded-xl">Very Rounded</option>
                                                            <option value="rounded-full">Circular</option>
                                                        </select>
                                                    </div>
                                                    
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">Shadow Style</label>
                                                        <select x-model="shadowStyle" @change="updatePreview()" 
                                                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                                            <option value="shadow-none">No Shadow</option>
                                                            <option value="shadow-sm">Small Shadow</option>
                                                            <option value="shadow-md">Medium Shadow</option>
                                                            <option value="shadow-lg">Large Shadow</option>
                                                            <option value="shadow-xl">Extra Large Shadow</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Right Column: Live Preview -->
                                        <div class="space-y-4">
                                            <h4 class="text-lg font-semibold">Live Preview</h4>
                                            
                                            <!-- Chat Widget Preview -->
                                            <div class="border rounded-lg overflow-hidden" :class="shadowStyle">
                                                <!-- Chat Header -->
                                                <div class="p-4 text-white" :style="`background-color: ${customColors.primary}`">
                                                    <div class="flex items-center">
                                                        <div class="w-8 h-8 rounded-full flex items-center justify-center mr-3" 
                                                            :style="`background-color: ${customColors.secondary}20`">
                                                            <i :class="selectedIcon" class="text-sm text-white"></i>
                                                        </div>
                                                        <div>
                                                            <h5 class="font-medium" x-text="botName || 'Your Bot'"></h5>
                                                            <p class="text-xs opacity-90">Online now</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Chat Messages -->
                                                <div class="h-64 p-4 overflow-y-auto" :style="`background-color: ${customColors.secondary}`">
                                                    <!-- Bot Message -->
                                                    <div class="mb-3">
                                                        <div class="max-w-xs p-3 text-white text-sm" 
                                                            :class="borderRadius"
                                                            :style="`background-color: ${customColors.primary}`">
                                                            Hello! How can I help you today?
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- User Message -->
                                                    <div class="mb-3 flex justify-end">
                                                        <div class="max-w-xs p-3 bg-gray-200 text-gray-800 text-sm" 
                                                            :class="borderRadius">
                                                            I need help with my order
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Bot Response -->
                                                    <div class="mb-3">
                                                        <div class="max-w-xs p-3 text-white text-sm" 
                                                            :class="borderRadius"
                                                            :style="`background-color: ${customColors.primary}`">
                                                            I'd be happy to help! Can you provide your order number?
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Chat Input -->
                                                <div class="p-4 border-t bg-white">
                                                    <div class="flex">
                                                        <input type="text" placeholder="Type your message..." 
                                                            class="flex-1 px-3 py-2 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                                            :class="borderRadius">
                                                        <button class="ml-2 px-4 py-2 text-white" 
                                                            :class="borderRadius"
                                                            :style="`background-color: ${customColors.accent}`">
                                                            <i class="fas fa-paper-plane"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Chat Button Preview -->
                                            <div class="mt-4">
                                                <h5 class="text-sm font-medium text-gray-700 mb-2">Chat Button Preview</h5>
                                                <div class="relative">
                                                    <div class="w-14 h-14 fixed bottom-4 right-4 text-white cursor-pointer flex items-center justify-center" 
                                                        :class="[borderRadius, shadowStyle]"
                                                        :style="`background-color: ${customColors.primary}`">
                                                        <i :class="selectedIcon" class="text-xl"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Preview Tab -->
                              <!-- Enhanced Preview Tab with Action Buttons -->
<div x-show="currentTab === 'preview'" class="space-y-6">
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <h4 class="font-semibold text-yellow-800 mb-2">Live Preview & Deployment</h4>
        <p class="text-yellow-700 text-sm">Test your bot configuration in real-time and deploy when ready.</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Chat Interface with Custom Design -->
        <div class="border rounded-lg overflow-hidden" :class="shadowStyle">
            <div class="text-white p-4" :style="`background-color: ${customColors.primary}`">
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center mr-3" 
                        :style="`background-color: ${customColors.secondary}20`">
                        <i :class="selectedIcon" class="text-sm text-white"></i>
                    </div>
                    <div>
                        <h4 class="font-semibold" x-text="botName"></h4>
                        <p class="text-sm opacity-90">Online now</p>
                    </div>
                </div>
            </div>
            <div class="h-96 p-4 overflow-y-auto" :style="`background-color: ${customColors.secondary}`">
                <!-- Sample conversation with custom styling -->
                <div class="mb-4">
                    <div class="text-white p-3 max-w-xs" 
                        :class="borderRadius"
                        :style="`background-color: ${customColors.primary}`">
                        Hello! How can I help you today?
                    </div>
                </div>
                <div class="mb-4 flex justify-end">
                    <div class="bg-gray-200 p-3 max-w-xs" :class="borderRadius">
                        I need help with my order
                    </div>
                </div>
                <div class="mb-4">
                    <div class="text-white p-3 max-w-xs" 
                        :class="borderRadius"
                        :style="`background-color: ${customColors.primary}`">
                        I'd be happy to help you with your order. Could you please provide your order number?
                    </div>
                </div>
            </div>
            <div class="p-4 border-t bg-white">
                <div class="flex">
                    <input type="text" placeholder="Type your message..." 
                        class="flex-1 px-3 py-2 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" 
                        :class="borderRadius">
                    <button class="ml-2 px-4 py-2 text-white" 
                        :class="borderRadius"
                        :style="`background-color: ${customColors.accent}`">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Test Scenarios and Configuration Summary -->
        <div class="space-y-6">
            <!-- Configuration Summary -->
            <div class="bg-white border rounded-lg p-4">
                <h4 class="font-semibold mb-3">📋 Configuration Summary</h4>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Bot Name:</span>
                        <span class="font-medium" x-text="botName"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Bot Type:</span>
                        <span class="font-medium" x-text="selectedType.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Design Enabled:</span>
                        <span class="font-medium" x-text="enablePersonaDesign ? 'Yes' : 'No'"></span>
                    </div>
                    <div class="flex justify-between" x-show="enablePersonaDesign">
                        <span class="text-gray-600">Theme:</span>
                        <span class="font-medium" x-text="personaDesigns[selectedPersona]?.name || 'Custom'"></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Primary Color:</span>
                        <div class="flex items-center">
                            <div class="w-4 h-4 rounded mr-2" :style="`background-color: ${customColors.primary}`"></div>
                            <span class="text-sm font-mono" x-text="customColors.primary"></span>
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Selected Icon:</span>
                        <i :class="selectedIcon" :style="`color: ${customColors.primary}`"></i>
                    </div>
                </div>
            </div>

            <!-- Quick Test Scenarios -->
            <div>
                <h4 class="font-semibold mb-3">🧪 Quick Test Scenarios</h4>
                <div class="space-y-2">
                    <button class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium">Greeting Test</div>
                        <div class="text-sm text-gray-600">"Hello, how are you?"</div>
                    </button>
                    <button class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium">Order Inquiry</div>
                        <div class="text-sm text-gray-600">"Where is my order #12345?"</div>
                    </button>
                    <button class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium">Pricing Question</div>
                        <div class="text-sm text-gray-600">"How much does your service cost?"</div>
                    </button>
                    <button class="w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="font-medium">Support Request</div>
                        <div class="text-sm text-gray-600">"I need help with my account"</div>
                    </button>
                </div>
            </div>

            <!-- Readiness Checklist -->
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                <h5 class="font-semibold text-green-800 mb-3">✅ Deployment Readiness</h5>
                <div class="space-y-2 text-sm">
                    <div class="flex items-center text-green-700">
                        <i class="fas fa-check-circle mr-2"></i>
                        <span>Bot configuration completed</span>
                    </div>
                    <div class="flex items-center text-green-700" x-show="selectedType !== ''">
                        <i class="fas fa-check-circle mr-2"></i>
                        <span>Bot type selected</span>
                    </div>
                    <div class="flex items-center" :class="enablePersonaDesign ? 'text-green-700' : 'text-gray-500'">
                        <i :class="enablePersonaDesign ? 'fas fa-check-circle' : 'fas fa-circle'" class="mr-2"></i>
                        <span>Design customization</span>
                        <span class="ml-1 text-xs" x-show="!enablePersonaDesign">(Optional)</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Deploy Bot Modal -->
<div x-show="showDeployModal" x-cloak class="fixed inset-0 z-50 overflow-y-auto">
    <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
        <!-- Background overlay -->
        <div class="fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75" 
             @click="showDeployModal = false"></div>

        <!-- Modal panel -->
        <div class="inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl">
            <!-- Modal Header -->
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-rocket text-blue-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-xl font-semibold text-gray-900">Deploy Your Bot</h3>
                        <p class="text-sm text-gray-500">Get your bot integration code</p>
                    </div>
                </div>
                <button @click="showDeployModal = false" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <!-- Content - Design Enabled -->
            <div x-show="enablePersonaDesign">
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h4 class="font-semibold text-green-800 mb-2">
                        <i class="fas fa-palette mr-2"></i>Custom Design Enabled
                    </h4>
                    <p class="text-green-700 text-sm">Your bot includes custom styling and persona design.</p>
                </div>

                <!-- Script Integration Tab -->
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <h5 class="font-semibold mb-3">
                        <i class="fas fa-code mr-2 text-blue-600"></i>Enhanced Script Integration
                    </h5>
                    <div class="bg-white rounded p-3 text-sm font-mono relative border">
                        <button @click="copyToClipboard('enhancedScript')" 
                                class="absolute top-2 right-2 px-2 py-1 bg-blue-100 text-blue-600 rounded text-xs hover:bg-blue-200">
                            <i class="fas fa-copy mr-1"></i>Copy
                        </button>
                        <div id="enhancedScript" class="text-xs text-gray-800 overflow-x-auto pr-16">
&lt;!-- Enhanced ChatBot Integration Script --&gt;
&lt;script&gt;
(function() {
    // Bot Configuration
    const botConfig = {
        botId: '<span x-text="botId || 'cb_' + Math.random().toString(36).substr(2, 9)"></span>',
        botName: '<span x-text="botName"></span>',
        botType: '<span x-text="selectedType"></span>',
        
        // Design Configuration
        design: {
            enabled: true,
            theme: '<span x-text="selectedPersona"></span>',
            colors: {
                primary: '<span x-text="customColors.primary"></span>',
                secondary: '<span x-text="customColors.secondary"></span>',
                accent: '<span x-text="customColors.accent"></span>',
                text: '<span x-text="customColors.text"></span>'
            },
            icon: '<span x-text="selectedIcon"></span>',
            borderRadius: '<span x-text="borderRadius"></span>',
            shadow: '<span x-text="shadowStyle"></span>'
        },
        
        // API Configuration
        apiEndpoint: 'https://api.chatbotstudio.com/v1/chat',
        position: 'bottom-right',
        autoOpen: false
    };
    
    // Create and inject bot script
    const script = document.createElement('script');
    script.src = 'https://cdn.chatbotstudio.com/widget.js';
    script.setAttribute('data-config', JSON.stringify(botConfig));
    document.head.appendChild(script);
})();
&lt;/script&gt;
                        </div>
                    </div>
                </div>

                <!-- API Integration Tab -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h5 class="font-semibold mb-3">
                        <i class="fas fa-plug mr-2 text-green-600"></i>REST API Integration
                    </h5>
                    <div class="space-y-3 text-sm">
                        <div>
                            <span class="font-medium">Endpoint:</span>
                            <div class="bg-white rounded p-2 mt-1 border font-mono text-xs">
                                POST https://api.chatbotstudio.com/v1/chat
                            </div>
                        </div>
                        <div>
                            <span class="font-medium">Headers:</span>
                            <div class="bg-white rounded p-2 mt-1 border font-mono text-xs">
Authorization: Bearer YOUR_API_KEY<br>
Content-Type: application/json<br>
X-Bot-ID: <span x-text="botId || 'cb_' + Math.random().toString(36).substr(2, 9)"></span>
                            </div>
                        </div>
                        <div>
                            <span class="font-medium">Sample Request:</span>
                            <div class="bg-white rounded p-2 mt-1 border font-mono text-xs">
{
  "message": "Hello, I need help",
  "userId": "user123",
  "design": {
    "theme": "<span x-text="selectedPersona"></span>",
    "colors": <span x-text="JSON.stringify(customColors, null, 2)"></span>
  }
}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content - Design Disabled -->
            <div x-show="!enablePersonaDesign">
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6">
                    <h4 class="font-semibold text-gray-800 mb-2">
                        <i class="fas fa-cog mr-2"></i>Basic Configuration
                    </h4>
                    <p class="text-gray-600 text-sm">Standard bot deployment without custom design.</p>
                </div>

                <!-- Basic Script -->
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <h5 class="font-semibold mb-3">
                        <i class="fas fa-code mr-2 text-blue-600"></i>Basic Script Integration
                    </h5>
                    <div class="bg-white rounded p-3 text-sm font-mono relative border">
                        <button @click="copyToClipboard('basicScript')" 
                                class="absolute top-2 right-2 px-2 py-1 bg-blue-100 text-blue-600 rounded text-xs hover:bg-blue-200">
                            <i class="fas fa-copy mr-1"></i>Copy
                        </button>
                        <div id="basicScript" class="text-xs text-gray-800 overflow-x-auto pr-16">
&lt;!-- Basic ChatBot Integration Script --&gt;
&lt;script&gt;
(function() {
    const botConfig = {
        botId: '<span x-text="botId || 'cb_' + Math.random().toString(36).substr(2, 9)"></span>',
        botName: '<span x-text="botName"></span>',
        botType: '<span x-text="selectedType"></span>',
        apiEndpoint: 'https://api.chatbotstudio.com/v1/basic-chat',
        position: 'bottom-right'
    };
    
    const script = document.createElement('script');
    script.src = 'https://cdn.chatbotstudio.com/basic-widget.js';
    script.setAttribute('data-config', JSON.stringify(botConfig));
    document.head.appendChild(script);
})();
&lt;/script&gt;
                        </div>
                    </div>
                </div>

                <!-- Basic API -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h5 class="font-semibold mb-3">
                        <i class="fas fa-plug mr-2 text-green-600"></i>Basic API Integration
                    </h5>
                    <div class="space-y-3 text-sm">
                        <div>
                            <span class="font-medium">Endpoint:</span>
                            <div class="bg-white rounded p-2 mt-1 border font-mono text-xs">
                                POST https://api.chatbotstudio.com/v1/basic-chat
                            </div>
                        </div>
                        <div>
                            <span class="font-medium">Sample Request:</span>
                            <div class="bg-white rounded p-2 mt-1 border font-mono text-xs">
{
  "message": "Hello, I need help",
  "botId": "<span x-text="botId || 'cb_' + Math.random().toString(36).substr(2, 9)"></span>",
  "userId": "user123"
}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upgrade Suggestion -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4">
                    <h5 class="font-semibold text-blue-800 mb-2">
                        <i class="fas fa-star mr-2"></i>Want Custom Design?
                    </h5>
                    <p class="text-blue-700 text-sm mb-3">Enable persona design to get enhanced scripts with custom styling options.</p>
                    <button @click="enablePersonaDesign = true; currentTab = 'persona'" 
                            class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 transition-colors">
                        <i class="fas fa-palette mr-1"></i>Enable Design Features
                    </button>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="flex justify-between items-center mt-6 pt-4 border-t">
                <div class="text-sm text-gray-500">
                    <i class="fas fa-info-circle mr-1"></i>
                    Need help? Check our <a href="#" class="text-blue-600 hover:text-blue-800">documentation</a>
                </div>
                <div class="flex space-x-3">
                    <button @click="showDeployModal = false" 
                            class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50 transition-colors">
                        Close
                    </button>
                    <button @click="finalizeDeployment()" 
                            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors">
                        <i class="fas fa-check mr-1"></i>Deploy Now
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- NEW: Action Buttons Section in Preview Tab -->
    <div class="border-t pt-6">
        <div class="bg-gray-50 rounded-lg p-6">
            <h4 class="text-lg font-semibold mb-4">🚀 Ready to Deploy?</h4>
            <p class="text-gray-600 mb-6">Your bot is configured and ready for deployment. You can save your progress or deploy now.</p>
            
            <div class="flex flex-col sm:flex-row gap-4">
                <!-- Save & Test Button -->
                <button @click="saveAndTest()" class="flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium">
                    <i class="fas fa-save mr-2"></i>Save & Test Configuration
                </button>
                
                <!-- Deploy Bot Button -->
                <button @click="showDeployModal = true" 
                        class="flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium">
                    <i class="fas fa-rocket mr-2"></i>Deploy Bot
                </button>
            </div>
            
            <!-- Additional Options -->
            <div class="flex justify-center mt-4">
                <button @click="currentTab = 'basic'" class="text-sm text-gray-500 hover:text-gray-700 transition-colors">
                    <i class="fas fa-arrow-left mr-1"></i>Back to Configuration
                </button>
            </div>
        </div>
    </div>
</div>

                                <!-- Action Buttons -->
                                <!-- Updated Action Buttons - Remove Deploy and Save & Test from here -->
<div class="flex justify-between pt-6 border-t">
    <button @click="currentTab = 'preview'" class="px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50">
        <i class="fas fa-save mr-2"></i>Save Draft
    </button>
    <div class="text-sm text-gray-500 flex items-center">
        <i class="fas fa-info-circle mr-2"></i>
        Save your progress and continue in the Preview tab
    </div>
</div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enhanced Analytics & Logs Tab -->
<!-- Enhanced Analytics & Logs Tab -->
<!-- Enhanced Analytics & Logs Tab -->
<div id="analytics" class="tab-content">
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">Analytics & Logs</h2>
        <p class="text-gray-600">Monitor performance, analyze conversations, and improve your bots with detailed reports.</p>
    </div>

    <!-- Overall Performance Stats -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-blue-600">3</div>
            <div class="text-gray-600">Active Chatbots</div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-green-600">2,847</div>
            <div class="text-gray-600">Total Messages</div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-purple-600">94.2%</div>
            <div class="text-gray-600">Avg Success Rate</div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl font-bold text-orange-600">1.2s</div>
            <div class="text-gray-600">Avg Response Time</div>
        </div>
    </div>

    <!-- Individual Chatbot Reports Section -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-semibold">📊 Individual Chatbot Reports</h3>
            <div class="flex space-x-3">
                <select class="px-3 py-2 border border-gray-300 rounded-md text-sm">
                    <option>Last 7 days</option>
                    <option>Last 30 days</option>
                    <option>Last 90 days</option>
                </select>
                <button class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700">
                    <i class="fas fa-download mr-2"></i>Export All Reports
                </button>
            </div>
        </div>

        <!-- Customer Support Bot Report -->
        <div class="border rounded-lg p-6 mb-6 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-4">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-headset text-blue-600 text-xl"></i>
                    </div>
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800">Customer Support Bot</h4>
                        <p class="text-sm text-gray-600">Created 2 days ago • Last active 5 minutes ago</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Active</span>
                    <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200">
                        <i class="fas fa-chart-line mr-1"></i>View Details
                    </button>
                </div>
            </div>

            <!-- Performance Metrics Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600">127</div>
                    <div class="text-sm text-blue-800">Conversations</div>
                    <div class="text-xs text-green-600 mt-1">↑ 15% from last week</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600">95.2%</div>
                    <div class="text-sm text-green-800">Success Rate</div>
                    <div class="text-xs text-green-600 mt-1">↑ 2.1% improvement</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-purple-600">1.1s</div>
                    <div class="text-sm text-purple-800">Avg Response</div>
                    <div class="text-xs text-green-600 mt-1">↓ 0.3s faster</div>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-orange-600">4.8/5</div>
                    <div class="text-sm text-orange-800">User Rating</div>
                    <div class="text-xs text-green-600 mt-1">↑ 0.2 increase</div>
                </div>
            </div>

            <!-- Recent Activity & Top Intents -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Recent Conversations -->
                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🕒 Recent Conversations</h5>
                    <div class="space-y-3">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Order Status Inquiry</span>
                                <span class="text-xs text-gray-500">2 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "Where is my order #12345?"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Resolved</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">98% Confidence</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Refund Request</span>
                                <span class="text-xs text-gray-500">15 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "I want to return my product"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Resolved</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">94% Confidence</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Intents -->
                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🎯 Top Intents This Week</h5>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Order Status</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 85%"></div>
                                </div>
                                <span class="text-xs text-gray-600">45 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Refund Request</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-green-600 h-2 rounded-full" style="width: 70%"></div>
                                </div>
                                <span class="text-xs text-gray-600">32 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Product Info</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-purple-600 h-2 rounded-full" style="width: 60%"></div>
                                </div>
                                <span class="text-xs text-gray-600">28 queries</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sales Assistant Bot Report -->
        <div class="border rounded-lg p-6 mb-6 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-4">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-chart-line text-green-600 text-xl"></i>
                    </div>
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800">Sales Assistant Bot</h4>
                        <p class="text-sm text-gray-600">Created 1 week ago • Last active 2 hours ago</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">Active</span>
                    <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200">
                        <i class="fas fa-chart-line mr-1"></i>View Details
                    </button>
                </div>
            </div>

            <!-- Performance Metrics Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600">89</div>
                    <div class="text-sm text-blue-800">Conversations</div>
                    <div class="text-xs text-green-600 mt-1">↑ 22% from last week</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600">92.7%</div>
                    <div class="text-sm text-green-800">Success Rate</div>
                    <div class="text-xs text-green-600 mt-1">↑ 1.8% improvement</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-purple-600">0.9s</div>
                    <div class="text-sm text-purple-800">Avg Response</div>
                    <div class="text-xs text-green-600 mt-1">↓ 0.2s faster</div>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-orange-600">$12.5K</div>
                    <div class="text-sm text-orange-800">Leads Generated</div>
                    <div class="text-xs text-green-600 mt-1">↑ $3.2K this week</div>
                </div>
            </div>

            <!-- Recent Activity & Top Intents -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🕒 Recent Conversations</h5>
                    <div class="space-y-3">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Pricing Inquiry</span>
                                <span class="text-xs text-gray-500">5 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "What's your pricing?"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Lead Captured</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">96% Confidence</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Demo Request</span>
                                <span class="text-xs text-gray-500">22 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "Can I see a demo?"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Demo Scheduled</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">99% Confidence</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🎯 Top Intents This Week</h5>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Pricing Inquiry</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-green-600 h-2 rounded-full" style="width: 90%"></div>
                                </div>
                                <span class="text-xs text-gray-600">38 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Demo Request</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                                </div>
                                <span class="text-xs text-gray-600">25 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Feature Questions</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-purple-600 h-2 rounded-full" style="width: 65%"></div>
                                </div>
                                <span class="text-xs text-gray-600">19 queries</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQ Bot Report -->
        <div class="border rounded-lg p-6 mb-6 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-4">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mr-4">
                        <i class="fas fa-question-circle text-gray-600 text-xl"></i>
                    </div>
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800">FAQ Bot</h4>
                        <p class="text-sm text-gray-600">Created 3 weeks ago • Last active yesterday</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm font-medium">Inactive</span>
                    <button class="px-3 py-1 bg-gray-100 text-gray-700 rounded-md text-sm hover:bg-gray-200">
                        <i class="fas fa-chart-line mr-1"></i>View Details
                    </button>
                </div>
            </div>

            <!-- Performance Metrics Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600">76</div>
                    <div class="text-sm text-blue-800">Conversations</div>
                    <div class="text-xs text-red-600 mt-1">↓ 8% from last week</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600">88.4%</div>
                    <div class="text-sm text-green-800">Success Rate</div>
                    <div class="text-xs text-red-600 mt-1">↓ 1.2% decline</div>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-purple-600">0.7s</div>
                    <div class="text-sm text-purple-800">Avg Response</div>
                    <div class="text-xs text-green-600 mt-1">↓ 0.1s faster</div>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-orange-600">4.3/5</div>
                    <div class="text-sm text-orange-800">User Rating</div>
                    <div class="text-xs text-red-600 mt-1">↓ 0.3 decrease</div>
                </div>
            </div>

            <!-- Recent Activity & Top Intents -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🕒 Recent Conversations</h5>
                    <div class="space-y-3">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Password Reset</span>
                                <span class="text-xs text-gray-500">10 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "How do I reset my password?"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded">Needs Review</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">72% Confidence</span>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-sm font-medium">Account Setup</span>
                                <span class="text-xs text-gray-500">35 min ago</span>
                            </div>
                            <div class="text-sm text-gray-600 mb-1">User: "How do I create an account?"</div>
                            <div class="flex space-x-2">
                                <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Resolved</span>
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">91% Confidence</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h5 class="font-semibold text-gray-800 mb-3">🎯 Top Intents This Week</h5>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Password Reset</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-red-600 h-2 rounded-full" style="width: 80%"></div>
                                </div>
                                <span class="text-xs text-gray-600">22 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">Account Setup</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 70%"></div>
                                </div>
                                <span class="text-xs text-gray-600">18 queries</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                            <span class="text-sm">General Help</span>
                            <div class="flex items-center">
                                <div class="w-20 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="bg-purple-600 h-2 rounded-full" style="width: 55%"></div>
                                </div>
                                <span class="text-xs text-gray-600">14 queries</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Improvement Suggestions -->
            <div class="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h5 class="font-semibold text-yellow-800 mb-2">💡 Improvement Suggestions</h5>
                <ul class="text-sm text-yellow-700 space-y-1">
                    <li>• Consider updating password reset responses (low confidence detected)</li>
                    <li>• Bot has been inactive - activate to improve user experience</li>
                    <li>• Add more training data for common FAQ queries</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Overall Logs Section -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Message Logs -->
        <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold">Recent Conversations</h3>
                <div class="flex space-x-2">
                    <button class="px-3 py-1 text-sm border rounded hover:bg-gray-50">Filter</button>
                    <button class="px-3 py-1 text-sm border rounded hover:bg-gray-50">Export</button>
                </div>
            </div>
            <div class="space-y-3">
                <div class="border rounded-lg p-3">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-medium">Customer Support Bot</div>
                        <div class="text-xs text-gray-500">2 min ago</div>
                    </div>
                    <div class="text-sm text-gray-600 mb-1">User: "I need help with my order"</div>
                    <div class="text-sm text-gray-600 mb-2">Bot: "I'd be happy to help! Can you provide your order number?"</div>
                    <div class="flex space-x-2">
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Confidence: 95%</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">Intent: order_inquiry</span>
                    </div>
                </div>
                <div class="border rounded-lg p-3">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-medium">Sales Assistant</div>
                        <div class="text-xs text-gray-500">5 min ago</div>
                    </div>
                    <div class="text-sm text-gray-600 mb-1">User: "What's your pricing?"</div>
                    <div class="text-sm text-gray-600 mb-2">Bot: "Our pricing starts at $9/month for the Starter plan..."</div>
                    <div class="flex space-x-2">
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Confidence: 98%</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">Intent: pricing_inquiry</span>
                    </div>
                </div>
                <div class="border rounded-lg p-3">
                    <div class="flex justify-between items-start mb-2">
                        <div class="text-sm font-medium">FAQ Bot</div>
                        <div class="text-xs text-gray-500">10 min ago</div>
                    </div>
                    <div class="text-sm text-gray-600 mb-1">User: "How do I reset my password?"</div>
                    <div class="text-sm text-gray-600 mb-2">Bot: "You can reset your password by clicking the 'Forgot Password' link..."</div>
                    <div class="flex space-x-2">
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded">Confidence: 72%</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">Intent: password_reset</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Summary -->
        <div class="space-y-6">
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-4">Performance Metrics</h3>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-600">Avg Response Time</span>
                        <span class="text-sm font-medium">1.2s</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-600">Success Rate</span>
                        <span class="text-sm font-medium text-green-600">94.2%</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-600">Avg Confidence</span>
                        <span class="text-sm font-medium">88.5%</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-600">Fallback Rate</span>
                        <span class="text-sm font-medium text-yellow-600">5.8%</span>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-4">Improvement Opportunities</h3>
                <div class="space-y-3">
                    <div class="border-l-4 border-yellow-500 pl-3">
                        <div class="text-sm font-medium">Low Confidence Queries</div>
                        <div class="text-xs text-gray-600">12 queries need attention</div>
                    </div>
                    <div class="border-l-4 border-red-500 pl-3">
                        <div class="text-sm font-medium">Missed Intents</div>
                        <div class="text-xs text-gray-600">8 new patterns detected</div>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-3">
                        <div class="text-sm font-medium">Popular Queries</div>
                        <div class="text-xs text-gray-600">Consider adding shortcuts</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



            <!-- Billing Tab -->
            <div id="billing" class="tab-content">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Billing & Usage</h2>
                    <p class="text-gray-600">Monitor your usage and manage billing information.</p>
                </div>

                <!-- Usage Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-3xl font-bold text-blue-600">$24.99</div>
                        <div class="text-gray-600">Current Bill</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-3xl font-bold text-green-600">2,847</div>
                        <div class="text-gray-600">Messages Used</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-3xl font-bold text-purple-600">7,153</div>
                        <div class="text-gray-600">Messages Remaining</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="text-3xl font-bold text-orange-600">Dec 15</div>
                        <div class="text-gray-600">Next Billing</div>
                    </div>
                </div>

                <!-- Billing History -->
                <div class="bg-white rounded-lg shadow p-6 mb-8">
                    <h3 class="text-xl font-semibold mb-4">Billing History</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Date</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Description</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Amount</th>
                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-600">Status</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="px-4 py-2 text-sm">Nov 15, 2024</td>
                                    <td class="px-4 py-2 text-sm">Pro Plan - Monthly</td>
                                    <td class="px-4 py-2 text-sm">$24.99</td>
                                    <td class="px-4 py-2 text-sm">
                                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Paid</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm">Oct 15, 2024</td>
                                    <td class="px-4 py-2 text-sm">Pro Plan - Monthly</td>
                                    <td class="px-4 py-2 text-sm">$24.99</td>
                                    <td class="px-4 py-2 text-sm">
                                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Paid</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 text-sm">Sep 15, 2024</td>
                                    <td class="px-4 py-2 text-sm">Starter Plan - Monthly</td>
                                    <td class="px-4 py-2 text-sm">$9.99</td>
                                    <td class="px-4 py-2 text-sm">
                                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Paid</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Subscription Plans -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-6">Subscription Plans</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                         <div class="border rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-2">Free</h4>
                            <div class="text-3xl font-bold mb-4">$0<span class="text-lg font-normal">/mo</span></div>
                            <ul class="space-y-2 text-sm text-gray-600 mb-6">
                                <li>• 1 Chatbots</li>
                                <li>• 500 Messages/month</li>
                                <li>• Basic Templates</li>
                                <li>• Email Support</li>
                            </ul>
                            <button class="w-full py-2 border border-gray-300 rounded hover:bg-gray-50">Choose Plan</button>
                        </div>
                        <div class="border rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-2">Starter</h4>
                            <div class="text-3xl font-bold mb-4">$9<span class="text-lg font-normal">/mo</span></div>
                            <ul class="space-y-2 text-sm text-gray-600 mb-6">
                                <li>• 2 Chatbots</li>
                                <li>• 1,000 Messages/month</li>
                                <li>• Basic Templates</li>
                                <li>• Email Support</li>
                            </ul>
                            <button class="w-full py-2 border border-gray-300 rounded hover:bg-gray-50">Choose Plan</button>
                        </div>
                        <div class="border-2 border-blue-500 rounded-lg p-6 relative">
                            <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                                <span class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm">Current Plan</span>
                            </div>
                            <h4 class="text-lg font-semibold mb-2">Pro</h4>
                            <div class="text-3xl font-bold mb-4">$24<span class="text-lg font-normal">/mo</span></div>
                            <ul class="space-y-2 text-sm text-gray-600 mb-6">
                                <li>• 10 Chatbots</li>
                                <li>• 10,000 Messages/month</li>
                                <li>• All Templates</li>
                                <li>• Priority Support</li>
                                <li>• Custom Integrations</li>
                            </ul>
                            <button class="w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Current Plan</button>
                        </div>
                        <div class="border rounded-lg p-6">
                            <h4 class="text-lg font-semibold mb-2">Enterprise</h4>
                            <div class="text-3xl font-bold mb-4">$99<span class="text-lg font-normal">/mo</span></div>
                            <ul class="space-y-2 text-sm text-gray-600 mb-6">
                                <li>• Unlimited Chatbots</li>
                                <li>• 100,000 Messages/month</li>
                                <li>• Premium Templates</li>
                                <li>• 24/7 Phone Support</li>
                                <li>• White-label Solution</li>
                            </ul>
                            <button class="w-full py-2 bg-green-600 text-white rounded hover:bg-green-700">Upgrade</button>
                        </div>
                    </div>
                </div>
            </div>
             
             <div id="settings" class="tab-content">
    <section id="account" class="content-section">
        <div class="page-header">
            <div class="icon">⚙️</div>
            <h1 class="page-title">Personal Information</h1>
        </div>

        <div class="success-message" id="successMessage">
            <span>✅</span>
            Settings updated successfully!
        </div>

        <!-- Personal Information Card -->
        <div class="settings-card">
            <form class="settings-form" id="personalInfoForm">
                <!-- Profile Picture Section -->
                <div class="profile-section">
                    <div class="profile-avatar" id="profileAvatar">AN</div>
                    <div class="profile-info">
                        <h3>Profile Picture</h3>
                        <p>Upload a professional photo to personalize your account</p>
                        <button type="button" class="upload-btn">
                            📷 Change Photo
                        </button>
                    </div>
                </div>

                <!-- Full Name -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">👤</span>
                        Full Name
                    </label>
                    <input type="text" name="fullName" class="form-input" value="Sam" placeholder="Enter your full name">
                </div>

                <!-- Email Address -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">📧</span>
                        Email Address
                    </label>
                    <input type="email" name="email" id="emailInput" class="form-input" value="sam@example.com" placeholder="Enter your email">
                </div>

                <!-- Phone Number -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">📱</span>
                        Phone Number
                    </label>
                    <input type="tel" name="phoneNumber" class="form-input" value="" placeholder="Enter your phone number">
                </div>

                <!-- Business Name -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">🏢</span>
                        Business Name
                    </label>
                    <input type="text" name="businessName" class="form-input" value="" placeholder="Enter your business name">
                </div>

                <!-- Job Title -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">💼</span>
                        Job Title
                    </label>
                    <input type="text" name="jobTitle" class="form-input" value="Full-Stack Developer" placeholder="Enter your job title">
                </div>

                <!-- Location -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">📍</span>
                        Location
                    </label>
                    <input type="text" name="location" class="form-input" value="" placeholder="Enter your location">
                </div>

                <!-- New Password -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">🔒</span>
                        New Password
                    </label>
                    <div class="password-container">
                        <input type="password" name="newPassword" class="form-input password" placeholder="Enter new password" id="newPassword">
                        <button type="button" class="password-toggle" onclick="togglePassword('newPassword')">👁️</button>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">🔒</span>
                        Confirm Password
                    </label>
                    <div class="password-container">
                        <input type="password" name="confirmPassword" class="form-input password" placeholder="Confirm new password" id="confirmPassword">
                        <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">👁️</button>
                    </div>
                </div>

                <!-- Time Zone -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">🌍</span>
                        Time Zone
                    </label>
                    <select name="timeZone" class="form-input">
                        <option value="EST">Eastern Time (EST)</option>
                        <option value="CST">Central Time (CST)</option>
                        <option value="MST">Mountain Time (MST)</option>
                        <option value="PST">Pacific Time (PST)</option>
                        <option value="UTC">UTC</option>
                        <option value="IST">Indian Standard Time (IST)</option>
                    </select>
                </div>

                <!-- Language -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="icon">🌐</span>
                        Language
                    </label>
                    <select name="language" class="form-input">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="pt">Portuguese</option>
                        <option value="hi">Hindi</option>
                    </select>
                </div>

                <!-- Bio -->
                <div class="form-group full-width">
                    <label class="form-label">
                        <span class="icon">📝</span>
                        Bio / Description
                    </label>
                    <textarea name="bio" class="form-input" rows="4" placeholder="Tell us about yourself and your business...">Intermediate-level Full-Stack Developer with 1-2 years of experience building scalable systems. Specializing in Python, Django, React.js, and Tailwind CSS for creating responsive web applications.</textarea>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="resetForm()">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        💾 Save Changes
                    </button>
                </div>
            </form>
        </div>

        <!-- Notification Settings -->
        <div class="settings-card">
            <div class="settings-section">
                <h2 class="section-title">
                    <span>🔔</span>
                    Notification Preferences
                </h2>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>Email Notifications</h4>
                        <p>Receive email updates about your chatbots and conversations</p>
                    </div>
                    <div class="toggle-switch active" onclick="toggleSwitch(this)"></div>
                </div>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>SMS Notifications</h4>
                        <p>Get SMS alerts for urgent messages</p>
                    </div>
                    <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                </div>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>Marketing Updates</h4>
                        <p>Receive news about new features and product updates</p>
                    </div>
                    <div class="toggle-switch active" onclick="toggleSwitch(this)"></div>
                </div>
            </div>
        </div>

        <!-- Privacy Settings -->
        <div class="settings-card">
            <div class="settings-section">
                <h2 class="section-title">
                    <span>🔍</span>
                    Privacy & Security
                </h2>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>Two-Factor Authentication</h4>
                        <p>Add an extra layer of security to your account</p>
                    </div>
                    <div class="toggle-switch" onclick="toggleSwitch(this)"></div>
                </div>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>Profile Visibility</h4>
                        <p>Make your profile visible to other team members</p>
                    </div>
                    <div class="toggle-switch active" onclick="toggleSwitch(this)"></div>
                </div>

                <div class="settings-item">
                    <div class="setting-info">
                        <h4>Data Analytics</h4>
                        <p>Help us improve our service by sharing usage analytics</p>
                    </div>
                    <div class="toggle-switch active" onclick="toggleSwitch(this)"></div>
                </div>
            </div>
        </div>
    </section>
</div>

            <!-- Settings Tab -->
        <!--     <div id="settings" class="tab-content">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Account Settings</h2>
                    <p class="text-gray-600">Manage your account information and preferences.</p>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" value="Anurag" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" value="anurag@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company</label>
                            <input type="text" placeholder="Your company name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex justify-end">
                            <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Save Changes</button>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>

    <script>
        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabLinks = document.querySelectorAll('nav a[href^="#"]');
            const tabContents = document.querySelectorAll('.tab-content');

            tabLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    
                    // Remove active class from all tabs
                    tabContents.forEach(content => content.classList.remove('active'));
                    tabLinks.forEach(link => {
                        link.classList.remove('border-r-3', 'border-blue-600', 'text-blue-600');
                        link.classList.add('text-gray-600');
                    });
                    
                    // Add active class to target tab
                    document.getElementById(targetId).classList.add('active');
                    this.classList.remove('text-gray-600');
                    this.classList.add('border-r-3', 'border-blue-600', 'text-blue-600');
                });
            });
        });
    </script>
    <script>
        let draggedItem = null;
        let nodeCounter = 0;

        // Drag and drop functionality
        document.querySelectorAll('.component-item').forEach(item => {
            item.addEventListener('dragstart', (e) => {
                draggedItem = e.target;
                e.dataTransfer.effectAllowed = 'copy';
            });
        });

        const workspace = document.getElementById('workspace');
        const dropZone = document.getElementById('dropZone');

        workspace.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
            dropZone.classList.add('active');
        });

        workspace.addEventListener('dragleave', (e) => {
            if (!workspace.contains(e.relatedTarget)) {
                dropZone.classList.remove('active');
            }
        });

        workspace.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('active');
            
            if (draggedItem) {
                const rect = workspace.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                createNode(draggedItem.dataset.type, x, y);
                draggedItem = null;
            }
        });

        function createNode(type, x, y) {
            nodeCounter++;
            const nodeId = `node_${type}_${nodeCounter}`;
            
            const node = document.createElement('div');
            node.className = `flow-node ${type}`;
            node.id = nodeId;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            
            let nodeContent = '';
            let hasCondition = false;
            
            if (type === 'condition') {
                hasCondition = true;
                nodeContent = `
                    <div class="node-title">IF</div>
                    <div class="node-desc">Condition</div>
                    <div class="connection-point input"></div>
                    <div class="connection-point output-true"></div>
                    <div class="connection-point output-false"></div>
                    <div class="branch-label true">TRUE</div>
                    <div class="branch-label false">FALSE</div>
                `;
            }
            
            node.innerHTML = nodeContent;
            
            // Make node draggable within workspace
            makeDraggable(node);
            
            workspace.appendChild(node);
        }

        function makeDraggable(element) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            element.addEventListener('mousedown', dragMouseDown);
            
            function dragMouseDown(e) {
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.addEventListener('mouseup', closeDragElement);
                document.addEventListener('mousemove', elementDrag);
            }
            
            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
            }
            
            function closeDragElement() {
                document.removeEventListener('mouseup', closeDragElement);
                document.removeEventListener('mousemove', elementDrag);
            }
        }
    </script>
<script>
// Global Variables
let currentPlan = 'free';
let onboardingStep = 0;
let selectedPlan = null;
let teams = []; // Store created teams
let teamMembers = []; // Store team members

// Step 1: Show Upgrade Modal
function showUpgradeModal() {
    const modal = createUpgradeModal();
    document.body.appendChild(modal);
}

function createUpgradeModal() {
    const modal = document.createElement('div');
    modal.id = 'upgradeModal';
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    modal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Choose Your Plan</h2>
                    <button onclick="closeUpgradeModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Free Plan -->
                    <div class="border rounded-lg p-6 text-center bg-gray-50">
                        <h3 class="text-xl font-bold mb-4">Free Plan</h3>
                        <div class="text-3xl font-bold text-gray-600 mb-2">$0</div>
                        <div class="text-gray-600 mb-4">per month</div>
                        <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium mb-4">Current Plan</div>
                        <ul class="text-left space-y-2 mb-6">
                            <li>✓ 1 Chatbot</li>
                            <li>✓ 100 conversations/month</li>
                            <li>✓ Basic templates</li>
                            <li>✗ No team features</li>
                            <li>✗ No role management</li>
                            <li>✗ Limited analytics</li>
                        </ul>
                    </div>

                    <!-- Enterprise Plan -->
                    <div class="border-2 border-purple-500 rounded-lg p-6 text-center bg-gradient-to-br from-purple-50 to-blue-50">
                        <div class="bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-medium mb-2 inline-block">Recommended</div>
                        <h3 class="text-xl font-bold mb-4">Enterprise</h3>
                        <div class="text-3xl font-bold text-purple-600 mb-2">$199</div>
                        <div class="text-gray-600 mb-4">per month</div>
                        <ul class="text-left space-y-2 mb-6">
                            <li>✓ <strong>Unlimited chatbots</strong></li>
                            <li>✓ <strong>Unlimited conversations</strong></li>
                            <li>✓ <strong>Full team management</strong></li>
                            <li>✓ <strong>Role assignment (Admin/Editor/Viewer)</strong></li>
                            <li>✓ <strong>Team-level analytics</strong></li>
                            <li>✓ <strong>Priority support</strong></li>
                            <li>✓ <strong>Advanced collaboration tools</strong></li>
                            <li>✓ <strong>White-label options</strong></li>
                        </ul>
                        <button onclick="proceedToPayment('enterprise', 199)" class="w-full py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold">
                            Upgrade to Enterprise - $199/month
                        </button>
                    </div>
                </div>
                
                <div class="text-center mt-6 text-gray-600">
                    <p><i class="fas fa-shield-alt mr-1"></i><strong>30-day money-back guarantee • Cancel anytime</strong></p>
                </div>
            </div>
        </div>
    `;
    return modal;
}

// Step 2: Handle Payment Process
function proceedToPayment(planType, price) {
    // Store selected plan
    selectedPlan = {
        type: planType,
        price: price,
        currency: 'USD'
    };
    
    closeUpgradeModal();
    showLoadingMessage('Preparing secure payment...');
    
    // Navigate to payment
    setTimeout(() => {
        showPaymentModal();
    }, 1500);
}

function showPaymentModal() {
    hideLoadingMessage();
    
    const paymentModal = document.createElement('div');
    paymentModal.id = 'paymentModal';
    paymentModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    paymentModal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Complete Payment</h2>
                    <button onclick="closePaymentModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <!-- Order Summary -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="font-semibold mb-2">Order Summary</h3>
                    <div class="flex justify-between items-center">
                        <span>${selectedPlan.type.charAt(0).toUpperCase() + selectedPlan.type.slice(1)} Plan</span>
                        <span class="font-bold">$${selectedPlan.price}/month</span>
                    </div>
                </div>
                
                <!-- Payment Form -->
                <form id="paymentForm" onsubmit="processPayment(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Card Number</label>
                            <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Expiry Date</label>
                                <input type="text" id="expiryDate" placeholder="MM/YY" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">CVV</label>
                                <input type="text" id="cvv" placeholder="123" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cardholder Name</label>
                            <input type="text" id="cardholderName" placeholder="John Doe" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full mt-6 py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold">
                        <i class="fas fa-lock mr-2"></i>Pay $${selectedPlan.price} Securely
                    </button>
                </form>
                
                <div class="text-center mt-4 text-xs text-gray-500">
                    <i class="fas fa-shield-alt mr-1"></i>Your payment is secured with 256-bit SSL encryption
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(paymentModal);
}

function processPayment(event) {
    event.preventDefault();
    
    const formData = {
        cardNumber: document.getElementById('cardNumber').value,
        expiryDate: document.getElementById('expiryDate').value,
        cvv: document.getElementById('cvv').value,
        cardholderName: document.getElementById('cardholderName').value,
        plan: selectedPlan
    };
    
    // Show payment processing
    showPaymentProcessing();
    
    // Simulate payment API call
    setTimeout(() => {
        handlePaymentSuccess();
    }, 3000);
}

function showPaymentProcessing() {
    const form = document.getElementById('paymentForm');
    form.innerHTML = `
        <div class="text-center py-8">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"></div>
            <p class="text-gray-700 font-medium">Processing your payment...</p>
            <p class="text-sm text-gray-500">Please don't close this window</p>
        </div>
    `;
}

function handlePaymentSuccess() {
    closePaymentModal();
    
    // Show success message
    showSuccessNotification('🎉 Payment successful! Upgrading your account...');
    
    // Upgrade the user's plan
    setTimeout(() => {
        upgradeToEnterprise();
    }, 2000);
}

function handlePaymentError(errorMessage) {
    showErrorNotification(`Payment failed: ${errorMessage}`);
}

// Step 3: Main Upgrade Function
function upgradeToEnterprise() {
    currentPlan = 'enterprise';
    
    // Show success notification
    showSuccessNotification('🎉 Welcome to Enterprise! Your dashboard is being updated...');
    
    // Step 4: Transform Dashboard
    setTimeout(() => {
        transformDashboardToEnterprise();
    }, 1000);
}

// Step 4: Dashboard Transformation
function transformDashboardToEnterprise() {
    // Update plan badge
    updatePlanBadge();
    
    // Hide free plan elements
    hideFreeElements();
    
    // Show enterprise elements
    showEnterpriseElements();
    
    // Update stats
    updateStatsForEnterprise();
    
    // Add team tags to chatbots
    addTeamTagsToChatbots();
    
    // Show onboarding flow
    showOnboardingFlow();
    
    // Assign admin role
    assignAdminRole();
    
    showSuccessNotification('Dashboard updated! You now have full Enterprise features.');
}

// Update plan badge
function updatePlanBadge() {
    const planBadge = document.getElementById('currentPlanBadge');
    planBadge.textContent = 'Enterprise';
    planBadge.className = 'px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium';
    
    // Hide upgrade button
    document.getElementById('upgradeButton').style.display = 'none';
}

// Hide free plan elements
function hideFreeElements() {
    const elementsToHide = [
        'freeUpgradeBanner',
        'chatbotLimitWarning', 
        'freeCreateLimit'
    ];
    
    elementsToHide.forEach(id => {
        const element = document.getElementById(id);
        if (element) element.style.display = 'none';
    });
}

// Show enterprise elements
function showEnterpriseElements() {
    const elementsToShow = [
        'enterpriseTeamSection',
        'enterpriseCreateOptions',
        'unlimitedBadge',
        'teamAnalytics'
    ];
    
    elementsToShow.forEach(id => {
        const element = document.getElementById(id);
        if (element) element.style.display = 'block';
    });
    
    // Show collaboration buttons on chatbots
    for (let i = 1; i <= 3; i++) {
        const collabBtn = document.getElementById(`bot${i}Collaborate`);
        if (collabBtn) collabBtn.style.display = 'inline-block';
    }
}

// Update stats for enterprise
function updateStatsForEnterprise() {
    const totalChatbots = document.getElementById('totalChatbots');
    totalChatbots.textContent = '∞';
    totalChatbots.className = 'text-3xl font-bold text-purple-600';
}

// Add team tags to chatbots
function addTeamTagsToChatbots() {
    document.getElementById('bot1TeamTag').style.display = 'inline-block';
    document.getElementById('bot2TeamTag').style.display = 'inline-block';
    document.getElementById('bot3PersonalTag').style.display = 'inline-block';
}

// Show onboarding flow
function showOnboardingFlow() {
    document.getElementById('enterpriseOnboarding').style.display = 'block';
    populateTeamsGrid();
}

// Assign admin role
function assignAdminRole() {
    console.log('User assigned Admin role with full access');
}

// NEW: Create Team Modal Function
function createTeam() {
    const createTeamModal = document.createElement('div');
    createTeamModal.id = 'createTeamModal';
    createTeamModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    createTeamModal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Create New Team</h2>
                    <button onclick="closeCreateTeamModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <form id="createTeamForm" onsubmit="handleCreateTeam(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Team Name</label>
                            <input type="text" id="teamName" placeholder="e.g., Marketing Team, Support Team" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                            <textarea id="teamDescription" placeholder="Brief description of the team's purpose" 
                                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-20 resize-none"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Team Color</label>
                            <div class="flex space-x-2">
                                <button type="button" onclick="selectTeamColor('blue')" class="w-8 h-8 bg-blue-500 rounded-full focus:ring-2 focus:ring-blue-300" id="color-blue"></button>
                                <button type="button" onclick="selectTeamColor('green')" class="w-8 h-8 bg-green-500 rounded-full focus:ring-2 focus:ring-green-300" id="color-green"></button>
                                <button type="button" onclick="selectTeamColor('purple')" class="w-8 h-8 bg-purple-500 rounded-full focus:ring-2 focus:ring-purple-300" id="color-purple"></button>
                                <button type="button" onclick="selectTeamColor('red')" class="w-8 h-8 bg-red-500 rounded-full focus:ring-2 focus:ring-red-300" id="color-red"></button>
                                <button type="button" onclick="selectTeamColor('yellow')" class="w-8 h-8 bg-yellow-500 rounded-full focus:ring-2 focus:ring-yellow-300" id="color-yellow"></button>
                                <button type="button" onclick="selectTeamColor('indigo')" class="w-8 h-8 bg-indigo-500 rounded-full focus:ring-2 focus:ring-indigo-300" id="color-indigo"></button>
                            </div>
                            <input type="hidden" id="selectedTeamColor" value="blue">
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button type="button" onclick="closeCreateTeamModal()" class="flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            <i class="fas fa-users mr-2"></i>Create Team
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    document.body.appendChild(createTeamModal);
    
    // Auto-focus on team name input
    setTimeout(() => {
        document.getElementById('teamName').focus();
    }, 100);
}

let selectedColor = 'blue';

function selectTeamColor(color) {
    // Remove previous selection
    document.querySelectorAll('[id^="color-"]').forEach(btn => {
        btn.classList.remove('ring-2', 'ring-offset-2');
    });
    
    // Add selection to clicked color
    document.getElementById(`color-${color}`).classList.add('ring-2', 'ring-offset-2');
    document.getElementById('selectedTeamColor').value = color;
    selectedColor = color;
}

function handleCreateTeam(event) {
    event.preventDefault();
    
    const teamName = document.getElementById('teamName').value;
    const teamDescription = document.getElementById('teamDescription').value;
    const teamColor = document.getElementById('selectedTeamColor').value;
    
    // Create team object
    const newTeam = {
        id: Date.now(),
        name: teamName,
        description: teamDescription,
        color: teamColor,
        members: [
            {
                id: 1,
                name: 'sam',
                email: 'sam@example.com',
                role: 'Admin',
                avatar: 'A'
            }
        ],
        chatbots: 0,
        createdAt: new Date()
    };
    
    // Add to teams array
    teams.push(newTeam);
    
    closeCreateTeamModal();
    showSuccessNotification(`Team "${teamName}" created successfully!`);
    
    // Refresh teams grid
    populateTeamsGrid();
}

function closeCreateTeamModal() {
    const modal = document.getElementById('createTeamModal');
    if (modal) modal.remove();
}

// NEW: Invite User Modal Function
function inviteUser() {
    const inviteUserModal = document.createElement('div');
    inviteUserModal.id = 'inviteUserModal';
    inviteUserModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    inviteUserModal.innerHTML = `
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Invite Team Member</h2>
                    <button onclick="closeInviteUserModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <form id="inviteUserForm" onsubmit="handleInviteUser(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" id="inviteEmail" placeholder="user@example.com" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" id="inviteName" placeholder="John Doe" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                            <select id="inviteRole" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="viewer">Viewer - Can view chatbots and analytics</option>
                                <option value="editor">Editor - Can create and edit chatbots</option>
                                <option value="admin">Admin - Full access to team management</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Assign to Team</label>
                            <select id="inviteTeam" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="">Select a team (optional)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Personal Message (Optional)</label>
                            <textarea id="inviteMessage" placeholder="Welcome to our team! We're excited to have you on board." 
                                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 h-20 resize-none"></textarea>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 mt-6">
                        <button type="button" onclick="closeInviteUserModal()" class="flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 py-2 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700">
                            <i class="fas fa-envelope mr-2"></i>Send Invitation
                        </button>
                    </div>
                </form>
            </div>
        </div>
    `;
    
    document.body.appendChild(inviteUserModal);
    
    // Populate teams dropdown
    const teamSelect = document.getElementById('inviteTeam');
    teams.forEach(team => {
        const option = document.createElement('option');
        option.value = team.id;
        option.textContent = team.name;
        teamSelect.appendChild(option);
    });
    
    // Auto-focus on email input
    setTimeout(() => {
        document.getElementById('inviteEmail').focus();
    }, 100);
}

function handleInviteUser(event) {
    event.preventDefault();
    
    const email = document.getElementById('inviteEmail').value;
    const name = document.getElementById('inviteName').value;
    const role = document.getElementById('inviteRole').value;
    const teamId = document.getElementById('inviteTeam').value;
    const message = document.getElementById('inviteMessage').value;
    
    // Create invitation object
    const invitation = {
        id: Date.now(),
        email: email,
        name: name,
        role: role,
        teamId: teamId,
        message: message,
        status: 'pending',
        sentAt: new Date()
    };
    
    // Add to team members array (simulate pending invitation)
    teamMembers.push({
        id: invitation.id,
        name: name,
        email: email,
        role: role,
        status: 'pending',
        avatar: name.charAt(0).toUpperCase()
    });
    
    closeInviteUserModal();
    
    // Show loading message
    showLoadingMessage('Sending invitation...');
    
    // Simulate sending invitation
    setTimeout(() => {
        hideLoadingMessage();
        showSuccessNotification(`🎉 Invitation sent to ${name} (${email})!`);
        
        // Update user management table
        updateUserManagementTable();
    }, 2000);
}

function closeInviteUserModal() {
    const modal = document.getElementById('inviteUserModal');
    if (modal) modal.remove();
}

// Update user management table
function updateUserManagementTable() {
    const tableBody = document.querySelector('#userManagementTable tbody');
    if (!tableBody) return;
    
    
    const existingRows = tableBody.querySelectorAll('tr');
    for (let i = 1; i < existingRows.length; i++) {
        existingRows[i].remove();
    }
    
    // Add pending invitations
    teamMembers.forEach(member => {
        if (member.status === 'pending') {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td class="px-4 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gray-400 rounded-full flex items-center justify-center text-white font-medium">${member.avatar}</div>
                        <div class="ml-3">
                            <div class="font-medium text-gray-900">${member.name}</div>
                            <div class="text-sm text-gray-500">${member.email}</div>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">${member.role} (Pending)</span>
                </td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">Not assigned</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Invitation sent</td>
                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                    <div class="flex space-x-2">
                        <button onclick="resendInvitation(${member.id})" class="text-blue-600 hover:text-blue-900">Resend</button>
                        <button onclick="cancelInvitation(${member.id})" class="text-red-600 hover:text-red-900">Cancel</button>
                    </div>
                </td>
            `;
            tableBody.appendChild(row);
        }
    });
}

function resendInvitation(memberId) {
    const member = teamMembers.find(m => m.id === memberId);
    if (member) {
        showSuccessNotification(`Invitation resent to ${member.name}!`);
    }
}

function cancelInvitation(memberId) {
    const memberIndex = teamMembers.findIndex(m => m.id === memberId);
    if (memberIndex > -1) {
        const member = teamMembers[memberIndex];
        teamMembers.splice(memberIndex, 1);
        showSuccessNotification(`Invitation to ${member.name} cancelled`);
        updateUserManagementTable();
    }
}

// Onboarding Functions
function createFirstTeam() {
    markStepComplete(1);
    createTeam(); // Open create team modal
}

function inviteFirstUser() {
    markStepComplete(2);
    inviteUser(); // Open invite user modal
}

function createTeamBot() {
    markStepComplete(3);
    showSuccessNotification('Team chatbot created successfully!');
    checkOnboardingComplete();
}

function markStepComplete(stepNumber) {
    const checkIcon = document.getElementById(`step${stepNumber}Check`);
    const stepDiv = document.getElementById(`step${stepNumber}`);
    
    if (checkIcon) checkIcon.style.display = 'inline-block';
    if (stepDiv) stepDiv.classList.add('opacity-75');
    
    onboardingStep = Math.max(onboardingStep, stepNumber);
}

function checkOnboardingComplete() {
    if (onboardingStep >= 3) {
        setTimeout(() => {
            document.getElementById('enterpriseOnboarding').style.display = 'none';
            showSuccessNotification('🎉 Onboarding complete! You\'re ready to collaborate with your team.');
        }, 2000);
    }
}

function dismissOnboarding() {
    document.getElementById('enterpriseOnboarding').style.display = 'none';
}

// Enhanced Populate teams grid
function populateTeamsGrid() {
    const teamsGrid = document.getElementById('teamsGrid');
    let teamsHTML = '';
    
    // Add existing teams
    teams.forEach(team => {
        const colorClasses = {
            blue: 'bg-blue-500',
            green: 'bg-green-500',
            purple: 'bg-purple-500',
            red: 'bg-red-500',
            yellow: 'bg-yellow-500',
            indigo: 'bg-indigo-500'
        };
        
        teamsHTML += `
            <div class="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-semibold">${team.name}</h4>
                        <p class="text-sm text-gray-600">${team.members.length} members • ${team.chatbots} chatbots</p>
                    </div>
                    <div class="dropdown relative">
                        <button class="text-gray-400 hover:text-gray-600 p-1">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    ${team.members.map(member => `
                        <div class="w-8 h-8 ${colorClasses[team.color]} rounded-full flex items-center justify-center text-white text-sm font-medium">${member.avatar}</div>
                    `).join('')}
                    <button onclick="inviteUser()" class="w-8 h-8 border-2 border-dashed border-gray-300 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600">
                        <i class="fas fa-plus text-xs"></i>
                    </button>
                </div>
            </div>
        `;
    });
    
    // Add default teams if no custom teams exist
    if (teams.length === 0) {
        teamsHTML += `
            <div class="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-semibold">Marketing Team</h4>
                        <p class="text-sm text-gray-600">3 members • 2 chatbots</p>
                    </div>
                    <div class="dropdown relative">
                        <button class="text-gray-400 hover:text-gray-600 p-1">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium">J</div>
                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium">S</div>
                    <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-medium">M</div>
                    <button onclick="inviteUser()" class="w-8 h-8 border-2 border-dashed border-gray-300 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600">
                        <i class="fas fa-plus text-xs"></i>
                    </button>
                </div>
            </div>
            
            <div class="bg-white border rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h4 class="font-semibold">Support Team</h4>
                        <p class="text-sm text-gray-600">2 members • 1 chatbot</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white text-sm font-medium">A</div>
                    <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-sm font-medium">K</div>
                    <button onclick="inviteUser()" class="w-8 h-8 border-2 border-dashed border-gray-300 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600">
                        <i class="fas fa-plus text-xs"></i>
                    </button>
                </div>
            </div>
        `;
    }
    
    // Add create new team card
    teamsHTML += `
        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 flex flex-col items-center justify-center text-center hover:border-purple-400 hover:bg-purple-50 transition-colors cursor-pointer" onclick="createTeam()">
            <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-2">
                <i class="fas fa-plus text-gray-400"></i>
            </div>
            <p class="text-gray-600 font-medium">Create New Team</p>
            <p class="text-xs text-gray-500">Organize projects and users</p>
        </div>
    `;
    
    teamsGrid.innerHTML = teamsHTML;
}

// Utility Functions
function closeUpgradeModal() {
    const modal = document.getElementById('upgradeModal');
    if (modal) modal.remove();
}

function closePaymentModal() {
    const modal = document.getElementById('paymentModal');
    if (modal) modal.remove();
}

function showLoadingMessage(message) {
    const loader = document.createElement('div');
    loader.id = 'paymentLoader';
    loader.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    loader.innerHTML = `
        <div class="bg-white rounded-lg p-6 text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"></div>
            <p class="text-gray-700">${message}</p>
        </div>
    `;
    document.body.appendChild(loader);
}

function hideLoadingMessage() {
    const loader = document.getElementById('paymentLoader');
    if (loader) loader.remove();
}

function showSuccessNotification(message) {
    const notification = document.createElement('div');
    notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 max-w-md';
    notification.innerHTML = `
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            ${message}
        </div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 4000);
}

function showErrorNotification(message) {
    const notification = document.createElement('div');
    notification.className = 'fixed top-4 right-4 bg-red-600 text-white px-6 py-3 rounded-lg shadow-lg z-50 max-w-md';
    notification.innerHTML = `
        <div class="flex items-center">
            <i class="fas fa-exclamation-circle mr-2"></i>
            ${message}
        </div>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 5000);
}

// Additional Enterprise Functions
function manageBotCollaboration(botId) {
    showSuccessNotification(`Managing collaboration for Bot ${botId}`);
}

function showChatbotLimitModal() {
    showUpgradeModal();
}

function createPersonalBot() {
    showSuccessNotification('Creating personal bot...');
}

// Input formatting for payment form
document.addEventListener('DOMContentLoaded', function() {
    document.addEventListener('input', function(e) {
        if (e.target.id === 'cardNumber') {
            let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
            let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
            if (formattedValue.length <= 19) {
                e.target.value = formattedValue;
            }
        }
        
        if (e.target.id === 'expiryDate') {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value;
        }
        
        if (e.target.id === 'cvv') {
            e.target.value = e.target.value.replace(/[^0-9]/g, '').substring(0, 4);
        }
    });
});
</script>


</body>
</html>